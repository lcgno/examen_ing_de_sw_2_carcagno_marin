[0m15:38:18.184747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b9d273b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b9b6aaf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b9c647e60>]}


============================== 15:38:18.190428 | 9e01a30f-3aff-4731-865a-c89c504a6212 ==============================
[0m15:38:18.190428 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:38:18.191293 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --project-dir /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/profiles', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_path': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/logs', 'write_json': 'True', 'log_cache_events': 'False'}
[0m15:38:18.797073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e01a30f-3aff-4731-865a-c89c504a6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b9a7f7e60>]}
[0m15:38:18.976286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e01a30f-3aff-4731-865a-c89c504a6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b8ed69460>]}
[0m15:38:18.981540 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:38:19.153811 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:38:19.154841 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:38:19.155461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9e01a30f-3aff-4731-865a-c89c504a6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b9a7aa630>]}
[0m15:38:21.028192 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:38:21.028941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9e01a30f-3aff-4731-865a-c89c504a6212', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b9b110c80>]}
[0m15:38:21.138822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e01a30f-3aff-4731-865a-c89c504a6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b8c889070>]}
[0m15:38:21.233458 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m15:38:21.237990 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m15:38:21.273926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e01a30f-3aff-4731-865a-c89c504a6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b8c803ec0>]}
[0m15:38:21.274628 [info ] [MainThread]: Found 2 models, 16 data tests, 469 macros
[0m15:38:21.275673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e01a30f-3aff-4731-865a-c89c504a6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b8c863fb0>]}
[0m15:38:21.278994 [info ] [MainThread]: 
[0m15:38:21.279937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:38:21.280441 [info ] [MainThread]: 
[0m15:38:21.281164 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:38:21.289077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m15:38:21.381212 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m15:38:21.382343 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m15:38:21.383386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:23.692760 [debug] [ThreadPool]: SQL status: OK in 2.309 seconds
[0m15:38:23.694816 [debug] [ThreadPool]: On list_medallion: Close
[0m15:38:23.696003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m15:38:23.696591 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m15:38:23.705052 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:38:23.705740 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m15:38:23.706223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:23.708187 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:38:23.709981 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:38:23.711124 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m15:38:23.712610 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:38:23.713111 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:38:23.713549 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m15:38:23.714726 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:38:23.716023 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:38:23.717104 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m15:38:23.717579 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m15:38:23.718807 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:38:23.719469 [debug] [ThreadPool]: On create_medallion_main: Close
[0m15:38:23.721222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m15:38:23.727976 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:38:23.728585 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m15:38:23.729120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:23.730452 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:38:23.731072 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m15:38:23.731666 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m15:38:23.748791 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:38:23.750701 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m15:38:23.752893 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m15:38:23.753416 [debug] [ThreadPool]: On list_medallion_main: Close
[0m15:38:23.754640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e01a30f-3aff-4731-865a-c89c504a6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b8c831700>]}
[0m15:38:23.755360 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:23.755812 [debug] [MainThread]: On master: BEGIN
[0m15:38:23.756247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:23.757517 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:38:23.757952 [debug] [MainThread]: On master: COMMIT
[0m15:38:23.758364 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:23.758789 [debug] [MainThread]: On master: COMMIT
[0m15:38:23.759966 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:38:23.760461 [debug] [MainThread]: On master: Close
[0m15:38:23.766894 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m15:38:23.767878 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m15:38:23.768605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m15:38:23.769098 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m15:38:23.780602 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m15:38:23.784280 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m15:38:23.821027 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m15:38:23.825733 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:38:23.826555 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m15:38:23.827220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:23.830341 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:38:23.830917 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m15:38:23.831629 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/data/clean/transactions_20251206_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m15:38:23.842732 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/data/clean/transactions_20251206_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
  );

[0m15:38:23.843430 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:38:23.844156 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m15:38:23.856825 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m15:38:23.857445 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m15:38:23.860875 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m15:38:23.863581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e01a30f-3aff-4731-865a-c89c504a6212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b8c1600e0>]}
[0m15:38:23.864494 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.09s]
[0m15:38:23.865394 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m15:38:23.866254 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^.
[0m15:38:23.868645 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m15:38:23.870169 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m15:38:23.870968 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m15:38:23.873816 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:23.874280 [debug] [MainThread]: On master: BEGIN
[0m15:38:23.874769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:23.876255 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:38:23.876806 [debug] [MainThread]: On master: COMMIT
[0m15:38:23.877501 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:23.877948 [debug] [MainThread]: On master: COMMIT
[0m15:38:23.879023 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:38:23.879701 [debug] [MainThread]: On master: Close
[0m15:38:23.880491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:23.881082 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m15:38:23.881698 [info ] [MainThread]: 
[0m15:38:23.882404 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m15:38:23.883774 [debug] [MainThread]: Command end result
[0m15:38:23.921641 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m15:38:23.924694 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m15:38:23.932876 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/run_results.json
[0m15:38:23.933579 [info ] [MainThread]: 
[0m15:38:23.934272 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:38:23.934824 [info ] [MainThread]: 
[0m15:38:23.935595 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m15:38:23.936597 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  Parser Error: syntax error at or near ")"
  
  LINE 16:   );
             ^
[0m15:38:23.937286 [info ] [MainThread]: 
[0m15:38:23.938123 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m15:38:23.938684 [info ] [MainThread]: 
[0m15:38:23.939295 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m15:38:23.940152 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:38:23.942032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.8462934, "process_in_blocks": "140392", "process_kernel_time": 1.428389, "process_mem_max_rss": "205716", "process_out_blocks": "45024", "process_user_time": 7.342565}
[0m15:38:23.942937 [debug] [MainThread]: Command `dbt run` failed at 15:38:23.942751 after 5.85 seconds
[0m15:38:23.943581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b9a883050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b9af446e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799b9af44cb0>]}
[0m15:38:23.944213 [debug] [MainThread]: Flushing usage events
[0m15:38:24.871894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:26:58.550261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb73a8bbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb739fc4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb739fc4230>]}


============================== 03:26:58.557093 | cacc4445-4add-431a-bd50-8e670b1bf8f1 ==============================
[0m03:26:58.557093 [info ] [MainThread]: Running with dbt=1.10.15
[0m03:26:58.557948 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'no_print': 'None', 'profiles_dir': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --project-dir /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/logs', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True'}
[0m03:26:59.098192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cacc4445-4add-431a-bd50-8e670b1bf8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb73ae788f0>]}
[0m03:26:59.188600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cacc4445-4add-431a-bd50-8e670b1bf8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb73aec9d90>]}
[0m03:26:59.193060 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:26:59.375579 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m03:26:59.610021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m03:26:59.611366 [debug] [MainThread]: Partial parsing: added file: medallion_dbt://tests/generic/id_valido.sql
[0m03:26:59.612810 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/schema.yml
[0m03:26:59.613606 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m03:26:59.614059 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/fct_customer_transactions.sql
[0m03:27:00.329654 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m03:27:00.330559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cacc4445-4add-431a-bd50-8e670b1bf8f1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72e4ecda0>]}
[0m03:27:00.439469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cacc4445-4add-431a-bd50-8e670b1bf8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb6ede1ba10>]}
[0m03:27:00.670249 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m03:27:00.674276 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m03:27:00.716106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cacc4445-4add-431a-bd50-8e670b1bf8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb6ede3a5d0>]}
[0m03:27:00.716845 [info ] [MainThread]: Found 2 models, 17 data tests, 470 macros
[0m03:27:00.717506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cacc4445-4add-431a-bd50-8e670b1bf8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb6ede25be0>]}
[0m03:27:00.721892 [info ] [MainThread]: 
[0m03:27:00.722837 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:27:00.723535 [info ] [MainThread]: 
[0m03:27:00.724906 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:27:00.734318 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m03:27:00.804653 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m03:27:00.805545 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m03:27:00.806054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:00.853957 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m03:27:00.856839 [debug] [ThreadPool]: On list_medallion: Close
[0m03:27:00.858355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m03:27:00.859030 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m03:27:00.874854 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:27:00.875750 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m03:27:00.880251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:00.883733 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m03:27:00.886675 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:27:00.887519 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m03:27:00.889733 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:27:00.890571 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:27:00.891155 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m03:27:00.893163 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:27:00.895836 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:27:00.896907 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m03:27:00.898117 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m03:27:00.900547 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:27:00.901140 [debug] [ThreadPool]: On create_medallion_main: Close
[0m03:27:00.903497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m03:27:00.911541 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:27:00.912804 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m03:27:00.913630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:00.916014 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:27:00.916784 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m03:27:00.917436 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m03:27:00.950445 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m03:27:00.953212 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m03:27:00.956379 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m03:27:00.958119 [debug] [ThreadPool]: On list_medallion_main: Close
[0m03:27:00.959747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cacc4445-4add-431a-bd50-8e670b1bf8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb6ede19100>]}
[0m03:27:00.960794 [debug] [MainThread]: Using duckdb connection "master"
[0m03:27:00.961463 [debug] [MainThread]: On master: BEGIN
[0m03:27:00.961926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:27:00.964480 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:27:00.965266 [debug] [MainThread]: On master: COMMIT
[0m03:27:00.965713 [debug] [MainThread]: Using duckdb connection "master"
[0m03:27:00.966266 [debug] [MainThread]: On master: COMMIT
[0m03:27:00.967533 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:27:00.968160 [debug] [MainThread]: On master: Close
[0m03:27:00.977424 [debug] [Thread-1 (]: Began running node model.medallion_dbt.stg_transactions
[0m03:27:00.978462 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m03:27:00.979481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_dbt.stg_transactions)
[0m03:27:00.980298 [debug] [Thread-1 (]: Began compiling node model.medallion_dbt.stg_transactions
[0m03:27:01.005963 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_dbt.stg_transactions"
[0m03:27:01.008584 [debug] [Thread-1 (]: Began executing node model.medallion_dbt.stg_transactions
[0m03:27:01.062878 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_dbt.stg_transactions"
[0m03:27:01.066319 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:27:01.067058 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: BEGIN
[0m03:27:01.068373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:01.070661 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:27:01.071220 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_dbt.stg_transactions"
[0m03:27:01.071732 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/data/clean/transactions_20251211_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar) as transaction_id,
    cast(customer_id as varchar) as customer_id,
    cast(amount as double) as amount,
    cast(lower(status) as varchar) as status,
    cast(transaction_ts as timestamp) as transaction_ts,
    cast(transaction_date as date) as transaction_date

from source
  );

[0m03:27:01.090407 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_dbt.stg_transactions"} */

  
  create view "medallion"."main"."stg_transactions__dbt_tmp" as (
    


with source as (
    select *
    from read_parquet(
        '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/data/clean/transactions_20251211_clean.parquet'
    )
)

-- TODO: Completar el modelo para que cree la tabla staging con los tipos adecuados segun el schema.yml.
select
    cast(transaction_id as varchar) as transaction_id,
    cast(customer_id as varchar) as customer_id,
    cast(amount as double) as amount,
    cast(lower(status) as varchar) as status,
    cast(transaction_ts as timestamp) as transaction_ts,
    cast(transaction_date as date) as transaction_date

from source
  );

[0m03:27:01.091015 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:27:01.091564 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: ROLLBACK
[0m03:27:01.104527 [debug] [Thread-1 (]: Failed to rollback 'model.medallion_dbt.stg_transactions'
[0m03:27:01.105454 [debug] [Thread-1 (]: On model.medallion_dbt.stg_transactions: Close
[0m03:27:01.109719 [debug] [Thread-1 (]: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/data/clean/transactions_20251211_clean.parquet"
  
  LINE 10:     from read_parquet(
                    ^
[0m03:27:01.113026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cacc4445-4add-431a-bd50-8e670b1bf8f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb6ec0ffcb0>]}
[0m03:27:01.114695 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.stg_transactions ..................... [[31mERROR[0m in 0.13s]
[0m03:27:01.115876 [debug] [Thread-1 (]: Finished running node model.medallion_dbt.stg_transactions
[0m03:27:01.117573 [debug] [Thread-7 (]: Marking all children of 'model.medallion_dbt.stg_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/data/clean/transactions_20251211_clean.parquet"
  
  LINE 10:     from read_parquet(
                    ^.
[0m03:27:01.120639 [debug] [Thread-3 (]: Began running node model.medallion_dbt.fct_customer_transactions
[0m03:27:01.121583 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.fct_customer_transactions ............................ [[33mSKIP[0m]
[0m03:27:01.122448 [debug] [Thread-3 (]: Finished running node model.medallion_dbt.fct_customer_transactions
[0m03:27:01.126410 [debug] [MainThread]: Using duckdb connection "master"
[0m03:27:01.127105 [debug] [MainThread]: On master: BEGIN
[0m03:27:01.127651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:27:01.129321 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:27:01.130067 [debug] [MainThread]: On master: COMMIT
[0m03:27:01.130820 [debug] [MainThread]: Using duckdb connection "master"
[0m03:27:01.131452 [debug] [MainThread]: On master: COMMIT
[0m03:27:01.133108 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:27:01.133800 [debug] [MainThread]: On master: Close
[0m03:27:01.134435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:01.134922 [debug] [MainThread]: Connection 'model.medallion_dbt.stg_transactions' was properly closed.
[0m03:27:01.135487 [info ] [MainThread]: 
[0m03:27:01.136162 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m03:27:01.137401 [debug] [MainThread]: Command end result
[0m03:27:01.168872 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m03:27:01.171364 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m03:27:01.181353 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/run_results.json
[0m03:27:01.181897 [info ] [MainThread]: 
[0m03:27:01.182449 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:27:01.182902 [info ] [MainThread]: 
[0m03:27:01.183420 [error] [MainThread]: [31mFailure in model stg_transactions (models/staging/stg_transactions.sql)[0m
[0m03:27:01.184127 [error] [MainThread]:   Runtime Error in model stg_transactions (models/staging/stg_transactions.sql)
  IO Error: No files found that match the pattern "/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/data/clean/transactions_20251211_clean.parquet"
  
  LINE 10:     from read_parquet(
                    ^
[0m03:27:01.184736 [info ] [MainThread]: 
[0m03:27:01.185326 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/stg_transactions.sql
[0m03:27:01.185827 [info ] [MainThread]: 
[0m03:27:01.186389 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m03:27:01.187084 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m03:27:01.188452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7295377, "process_in_blocks": "113488", "process_kernel_time": 0.913159, "process_mem_max_rss": "157272", "process_out_blocks": "3216", "process_user_time": 4.040634}
[0m03:27:01.189028 [debug] [MainThread]: Command `dbt run` failed at 03:27:01.188920 after 2.73 seconds
[0m03:27:01.189448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb73afe9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb6edf36fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb72c013200>]}
[0m03:27:01.189845 [debug] [MainThread]: Flushing usage events
[0m03:27:02.034391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:07.169208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a53727a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5393780b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5391e40e0>]}


============================== 17:35:07.182535 | d0b7cc43-3515-4359-b1a2-b99ad978e074 ==============================
[0m17:35:07.182535 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:35:07.183544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/logs', 'empty': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/profiles'}
[0m17:35:07.789543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0b7cc43-3515-4359-b1a2-b99ad978e074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a5390c15e0>]}
[0m17:35:07.893700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0b7cc43-3515-4359-b1a2-b99ad978e074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a538e29ac0>]}
[0m17:35:07.905305 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:35:08.101541 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:35:08.299233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:35:08.300135 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/marts/schema.yml
[0m17:35:08.300941 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://tests/generic/id_valido.sql
[0m17:35:08.965164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0b7cc43-3515-4359-b1a2-b99ad978e074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4fe43fc50>]}
[0m17:35:09.147806 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:35:09.156483 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:35:09.219183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0b7cc43-3515-4359-b1a2-b99ad978e074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4fe4a3b00>]}
[0m17:35:09.220471 [info ] [MainThread]: Found 2 models, 17 data tests, 470 macros
[0m17:35:09.221999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0b7cc43-3515-4359-b1a2-b99ad978e074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4fe589970>]}
[0m17:35:09.230147 [info ] [MainThread]: 
[0m17:35:09.231106 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:35:09.232075 [info ] [MainThread]: 
[0m17:35:09.233145 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:09.239603 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m17:35:09.323714 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:35:09.324350 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m17:35:09.324815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:09.368468 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m17:35:09.369406 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:35:09.369987 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m17:35:09.401576 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m17:35:09.405084 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m17:35:09.407666 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m17:35:09.408194 [debug] [ThreadPool]: On list_medallion_main: Close
[0m17:35:09.409300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0b7cc43-3515-4359-b1a2-b99ad978e074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4fe519a60>]}
[0m17:35:09.409994 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:09.410575 [debug] [MainThread]: On master: BEGIN
[0m17:35:09.411065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:09.412909 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:35:09.413493 [debug] [MainThread]: On master: COMMIT
[0m17:35:09.413969 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:09.414518 [debug] [MainThread]: On master: COMMIT
[0m17:35:09.415793 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:09.416560 [debug] [MainThread]: On master: Close
[0m17:35:09.423588 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:09.424231 [debug] [Thread-2 (]: Began running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:09.424943 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:09.425564 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:09.426175 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m17:35:09.427184 [info ] [Thread-2 (]: 2 of 17 START test id_valido_fct_customer_transactions_customer_id ............. [RUN]
[0m17:35:09.428877 [info ] [Thread-3 (]: 3 of 17 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m17:35:09.430090 [info ] [Thread-4 (]: 4 of 17 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m17:35:09.431317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m17:35:09.432322 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:35:09.433570 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:35:09.434732 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:35:09.436095 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:09.438609 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:09.440432 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:09.441390 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:09.459187 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:09.468297 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:09.474878 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:09.485013 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:09.487319 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:09.488693 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:09.489357 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:09.490009 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:09.527883 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:09.529372 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:09.532908 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:09.535501 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:09.537562 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:09.538784 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:09.539372 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:09.540043 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:09.540586 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m17:35:09.541286 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: BEGIN
[0m17:35:09.541964 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m17:35:09.542630 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m17:35:09.543239 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:35:09.543869 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:35:09.544517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:09.545374 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:35:09.549078 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:35:09.549976 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:35:09.551057 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:35:09.551955 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:09.553047 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:35:09.554626 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:09.555896 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:09.557388 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.559692 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:09.560953 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:35:09.561981 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.563666 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.572015 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.573102 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.573690 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:35:09.574615 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.575318 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.576044 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: ROLLBACK
[0m17:35:09.576700 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.577410 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.578183 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.582372 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m17:35:09.583814 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m17:35:09.585116 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m17:35:09.629233 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:35:09.633217 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:35:09.635057 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:35:09.637347 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m17:35:09.638796 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m17:35:09.639814 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m17:35:09.640787 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: Close
[0m17:35:09.641460 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m17:35:09.648532 [debug] [Thread-4 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:09.656042 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:09.654223 [error] [Thread-4 (]: 4 of 17 ERROR non_negative_fct_customer_transactions_total_amount_completed .... [[31mERROR[0m in 0.22s]
[0m17:35:09.658303 [debug] [Thread-2 (]: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:35:09.660381 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:35:09.661317 [error] [Thread-3 (]: 3 of 17 ERROR non_negative_fct_customer_transactions_total_amount_all .......... [[31mERROR[0m in 0.23s]
[0m17:35:09.662793 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:09.663872 [error] [Thread-2 (]: 2 of 17 ERROR id_valido_fct_customer_transactions_customer_id .................. [[31mERROR[0m in 0.23s]
[0m17:35:09.666179 [error] [Thread-1 (]: 1 of 17 ERROR accepted_values_stg_transactions_status__completed__pending__failed  [[31mERROR[0m in 0.23s]
[0m17:35:09.668705 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:09.670014 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:09.670958 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:09.671946 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:09.672827 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:09.673479 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:09.674430 [info ] [Thread-4 (]: 5 of 17 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m17:35:09.676280 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:09.677309 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:09.678086 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:09.678843 [info ] [Thread-3 (]: 6 of 17 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m17:35:09.679749 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4)
[0m17:35:09.680813 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad' to be skipped because of status 'error'.  Reason: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^.
[0m17:35:09.681533 [info ] [Thread-2 (]: 7 of 17 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m17:35:09.682696 [info ] [Thread-1 (]: 8 of 17 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m17:35:09.684298 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m17:35:09.685444 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:09.687274 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26' to be skipped because of status 'error'.  Reason: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^.
[0m17:35:09.688546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m17:35:09.689564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m17:35:09.690609 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:09.696392 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:09.697545 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:09.698311 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:09.704507 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:09.720432 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:09.721113 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:09.725733 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:09.729319 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:09.730137 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:09.730877 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:09.734601 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:09.738400 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:09.740452 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:09.744166 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:09.745105 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m17:35:09.748313 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:09.750286 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:09.751313 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:09.752579 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:09.754453 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m17:35:09.756894 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:09.758358 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m17:35:09.759007 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:35:09.759836 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:09.760747 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m17:35:09.761410 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:35:09.762039 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:09.763498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:09.765279 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:35:09.766566 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.767767 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:35:09.770549 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:09.772491 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:35:09.774970 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:09.776803 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.779025 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.780062 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:09.781153 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.784040 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.787313 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:35:09.788958 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.790803 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m17:35:09.792116 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.792859 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.795981 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.797000 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.799312 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m17:35:09.800906 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m17:35:09.801775 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m17:35:09.802542 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.803323 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m17:35:09.808991 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m17:35:09.811109 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m17:35:09.814714 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m17:35:09.819336 [debug] [Thread-4 (]: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:09.820455 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m17:35:09.822388 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m17:35:09.822931 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m17:35:09.823751 [error] [Thread-4 (]: 5 of 17 ERROR non_negative_fct_customer_transactions_transaction_count ......... [[31mERROR[0m in 0.14s]
[0m17:35:09.825855 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m17:35:09.828087 [debug] [Thread-3 (]: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:09.831207 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:09.835970 [debug] [Thread-2 (]: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:09.837128 [error] [Thread-3 (]: 6 of 17 ERROR non_negative_stg_transactions_amount ............................. [[31mERROR[0m in 0.15s]
[0m17:35:09.839172 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:09.839871 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:09.840593 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:09.841375 [error] [Thread-2 (]: 7 of 17 ERROR not_null_fct_customer_transactions_customer_id ................... [[31mERROR[0m in 0.15s]
[0m17:35:09.842327 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:09.843064 [error] [Thread-1 (]: 8 of 17 ERROR not_null_fct_customer_transactions_total_amount_all .............. [[31mERROR[0m in 0.15s]
[0m17:35:09.843945 [info ] [Thread-4 (]: 9 of 17 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m17:35:09.845329 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:09.845978 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:09.846869 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:09.847691 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:09.848491 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m17:35:09.849241 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:09.849883 [info ] [Thread-3 (]: 10 of 17 START test not_null_fct_customer_transactions_transaction_count ....... [RUN]
[0m17:35:09.850941 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:09.851646 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:09.852338 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:09.853043 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_transactions_amount ........................... [RUN]
[0m17:35:09.853887 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m17:35:09.854690 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:09.855312 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m17:35:09.860405 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:09.861421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m17:35:09.862090 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:09.863384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m17:35:09.864688 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:09.866057 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:09.871927 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:09.872868 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:09.878947 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:09.882191 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:09.888498 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:09.890220 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:09.891158 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:09.894453 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:09.895213 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:09.896092 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:09.899762 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:09.901825 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m17:35:09.906681 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:09.908216 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:09.912265 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:09.914055 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:09.915871 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m17:35:09.917240 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:09.918549 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m17:35:09.919333 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:09.919876 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:35:09.920596 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m17:35:09.921346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:35:09.922412 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:09.923161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:09.923712 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:35:09.924815 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.925851 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:35:09.926433 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:09.927143 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:35:09.928538 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.929309 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:09.930114 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.930833 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:09.931563 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.932311 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.933590 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.934300 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.934982 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m17:35:09.936387 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.937229 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:09.937818 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.940062 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.942559 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m17:35:09.943862 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:09.945557 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m17:35:09.947228 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m17:35:09.948866 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m17:35:09.951078 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m17:35:09.956573 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m17:35:09.964895 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m17:35:09.966175 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m17:35:09.967728 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:09.968959 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m17:35:09.970818 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m17:35:09.972885 [error] [Thread-4 (]: 9 of 17 ERROR not_null_fct_customer_transactions_total_amount_completed ........ [[31mERROR[0m in 0.12s]
[0m17:35:09.974986 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:09.977690 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m17:35:09.979392 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:09.982149 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:09.983490 [error] [Thread-3 (]: 10 of 17 ERROR not_null_fct_customer_transactions_transaction_count ............ [[31mERROR[0m in 0.13s]
[0m17:35:09.986625 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:09.988828 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:09.992323 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:09.990494 [error] [Thread-2 (]: 11 of 17 ERROR not_null_stg_transactions_amount ................................ [[31mERROR[0m in 0.13s]
[0m17:35:09.993924 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:09.994634 [info ] [Thread-4 (]: 13 of 17 START test not_null_stg_transactions_status ........................... [RUN]
[0m17:35:09.996066 [error] [Thread-1 (]: 12 of 17 ERROR not_null_stg_transactions_customer_id ........................... [[31mERROR[0m in 0.13s]
[0m17:35:09.998322 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:09.999192 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:09.999983 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:10.000590 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m17:35:10.001472 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:10.002134 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:10.002805 [info ] [Thread-3 (]: 14 of 17 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m17:35:10.003903 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:10.004716 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:10.005446 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:10.006064 [info ] [Thread-2 (]: 15 of 17 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m17:35:10.006963 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m17:35:10.007799 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:10.014766 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:10.016113 [info ] [Thread-1 (]: 16 of 17 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m17:35:10.017751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m17:35:10.018814 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:10.021302 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:10.022671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m17:35:10.023763 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:10.029392 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:10.033375 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:10.034363 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:10.039242 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:10.046599 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:10.047500 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:10.049661 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:10.050876 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m17:35:10.053797 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:10.054554 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:10.055546 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:10.056580 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:10.060837 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:10.062649 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:10.067552 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:10.069775 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m17:35:10.070944 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m17:35:10.071985 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:10.073436 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:10.074242 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:10.074857 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:10.075480 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m17:35:10.076259 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:35:10.077665 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m17:35:10.078435 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:35:10.079022 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:35:10.080139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:10.081021 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:35:10.082084 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:10.082710 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:35:10.083620 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:10.084356 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:35:10.084958 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:35:10.085607 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:10.086475 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m17:35:10.087804 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:10.088805 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:35:10.089423 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:10.092952 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:35:10.095499 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m17:35:10.096420 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:10.098531 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:10.099357 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m17:35:10.100198 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:35:10.101155 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m17:35:10.102303 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:10.104517 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:10.108289 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.114978 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m17:35:10.117406 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m17:35:10.121174 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m17:35:10.122353 [error] [Thread-4 (]: 13 of 17 ERROR not_null_stg_transactions_status ................................ [[31mERROR[0m in 0.12s]
[0m17:35:10.127638 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m17:35:10.130098 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m17:35:10.131278 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:10.133127 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m17:35:10.135134 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m17:35:10.136149 [debug] [Thread-4 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:10.139573 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.140568 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m17:35:10.141496 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:10.143543 [info ] [Thread-4 (]: 17 of 17 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m17:35:10.146042 [error] [Thread-3 (]: 14 of 17 ERROR not_null_stg_transactions_transaction_date ...................... [[31mERROR[0m in 0.14s]
[0m17:35:10.150704 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.155521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m17:35:10.157527 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.158557 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:10.159349 [error] [Thread-2 (]: 15 of 17 ERROR not_null_stg_transactions_transaction_id ........................ [[31mERROR[0m in 0.14s]
[0m17:35:10.160201 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:10.161142 [error] [Thread-1 (]: 16 of 17 ERROR not_null_stg_transactions_transaction_ts ........................ [[31mERROR[0m in 0.14s]
[0m17:35:10.162308 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:10.163206 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:10.172320 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:10.173604 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:10.174820 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:10.175903 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:10.176690 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:10.183019 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:10.184840 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:10.185631 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m17:35:10.186741 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:10.188848 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:35:10.189639 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:10.190319 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:35:10.191705 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:35:10.192398 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:10.193244 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m17:35:10.197799 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m17:35:10.199402 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m17:35:10.204594 [debug] [Thread-4 (]: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.205852 [error] [Thread-4 (]: 17 of 17 ERROR unique_stg_transactions_transaction_id .......................... [[31mERROR[0m in 0.05s]
[0m17:35:10.207547 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:10.208955 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:10.213668 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:10.214542 [debug] [MainThread]: On master: BEGIN
[0m17:35:10.215010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:10.216434 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:10.217204 [debug] [MainThread]: On master: COMMIT
[0m17:35:10.217737 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:10.218239 [debug] [MainThread]: On master: COMMIT
[0m17:35:10.219630 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:10.220153 [debug] [MainThread]: On master: Close
[0m17:35:10.220840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:10.221311 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m17:35:10.221708 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m17:35:10.222191 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m17:35:10.222606 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m17:35:10.223156 [info ] [MainThread]: 
[0m17:35:10.224180 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m17:35:10.229958 [debug] [MainThread]: Command end result
[0m17:35:10.268372 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:35:10.275356 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:35:10.292911 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/run_results.json
[0m17:35:10.293932 [info ] [MainThread]: 
[0m17:35:10.294806 [info ] [MainThread]: [31mCompleted with 17 errors, 0 partial successes, and 0 warnings:[0m
[0m17:35:10.295580 [info ] [MainThread]: 
[0m17:35:10.296481 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:35:10.297635 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:10.298302 [info ] [MainThread]: 
[0m17:35:10.299281 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_completed.sql
[0m17:35:10.300130 [info ] [MainThread]: 
[0m17:35:10.301886 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:35:10.302717 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:10.303494 [info ] [MainThread]: 
[0m17:35:10.304267 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_all.sql
[0m17:35:10.304921 [info ] [MainThread]: 
[0m17:35:10.305516 [error] [MainThread]: [31mFailure in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:35:10.306075 [error] [MainThread]:   Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:35:10.306582 [info ] [MainThread]: 
[0m17:35:10.307196 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/id_valido_fct_customer_transactions_customer_id.sql
[0m17:35:10.307687 [info ] [MainThread]: 
[0m17:35:10.308237 [error] [MainThread]: [31mFailure in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)[0m
[0m17:35:10.308834 [error] [MainThread]:   Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:35:10.309356 [info ] [MainThread]: 
[0m17:35:10.310122 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/accepted_values_stg_transactio_5bdf616555c30e299c6e421df7d58f81.sql
[0m17:35:10.311082 [info ] [MainThread]: 
[0m17:35:10.312239 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:35:10.313207 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:10.313825 [info ] [MainThread]: 
[0m17:35:10.314479 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_transaction_count.sql
[0m17:35:10.315923 [info ] [MainThread]: 
[0m17:35:10.317164 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:35:10.318113 [error] [MainThread]:   Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.318732 [info ] [MainThread]: 
[0m17:35:10.319346 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/non_negative_stg_transactions_amount.sql
[0m17:35:10.319817 [info ] [MainThread]: 
[0m17:35:10.320364 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:35:10.320963 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:10.321481 [info ] [MainThread]: 
[0m17:35:10.322013 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_customer_id.sql
[0m17:35:10.322529 [info ] [MainThread]: 
[0m17:35:10.323144 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:35:10.323710 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:10.324208 [info ] [MainThread]: 
[0m17:35:10.324792 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_all.sql
[0m17:35:10.325328 [info ] [MainThread]: 
[0m17:35:10.325883 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:35:10.326833 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:10.327633 [info ] [MainThread]: 
[0m17:35:10.328446 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_completed.sql
[0m17:35:10.329297 [info ] [MainThread]: 
[0m17:35:10.330238 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:35:10.331004 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:10.331687 [info ] [MainThread]: 
[0m17:35:10.332403 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_transaction_count.sql
[0m17:35:10.333065 [info ] [MainThread]: 
[0m17:35:10.333940 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:35:10.335004 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.335669 [info ] [MainThread]: 
[0m17:35:10.336400 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_amount.sql
[0m17:35:10.337126 [info ] [MainThread]: 
[0m17:35:10.338000 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_customer_id (models/staging/schema.yml)[0m
[0m17:35:10.338585 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.339052 [info ] [MainThread]: 
[0m17:35:10.339632 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_customer_id.sql
[0m17:35:10.340097 [info ] [MainThread]: 
[0m17:35:10.340655 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_status (models/staging/schema.yml)[0m
[0m17:35:10.341268 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.341763 [info ] [MainThread]: 
[0m17:35:10.342298 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_status.sql
[0m17:35:10.342844 [info ] [MainThread]: 
[0m17:35:10.343952 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)[0m
[0m17:35:10.345606 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.348586 [info ] [MainThread]: 
[0m17:35:10.349891 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_date.sql
[0m17:35:10.350751 [info ] [MainThread]: 
[0m17:35:10.351638 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:35:10.352321 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.352875 [info ] [MainThread]: 
[0m17:35:10.353554 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_id.sql
[0m17:35:10.354141 [info ] [MainThread]: 
[0m17:35:10.355058 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)[0m
[0m17:35:10.355711 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.356266 [info ] [MainThread]: 
[0m17:35:10.356962 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_ts.sql
[0m17:35:10.357567 [info ] [MainThread]: 
[0m17:35:10.358253 [error] [MainThread]: [31mFailure in test unique_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:35:10.358918 [error] [MainThread]:   Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:10.359444 [info ] [MainThread]: 
[0m17:35:10.359989 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/unique_stg_transactions_transaction_id.sql
[0m17:35:10.360595 [info ] [MainThread]: 
[0m17:35:10.361259 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=17 SKIP=0 NO-OP=0 TOTAL=17
[0m17:35:10.362689 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.2891862, "process_in_blocks": "110872", "process_kernel_time": 1.134562, "process_mem_max_rss": "159472", "process_out_blocks": "3680", "process_user_time": 4.86983}
[0m17:35:10.363457 [debug] [MainThread]: Command `dbt test` failed at 17:35:10.363288 after 3.29 seconds
[0m17:35:10.364018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a536d1e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4fe55a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a536890770>]}
[0m17:35:10.364704 [debug] [MainThread]: Flushing usage events
[0m17:35:11.147958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:20.878635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7ba4518b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7b953f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7bbb6be00>]}


============================== 17:35:20.885986 | a9cc8e24-7465-4ff0-b4f0-bb20fa2815e6 ==============================
[0m17:35:20.885986 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:35:20.886938 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/logs', 'no_print': 'None', 'profiles_dir': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/profiles', 'partial_parse': 'True', 'invocation_command': 'dbt test --project-dir /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt', 'use_colors': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None'}
[0m17:35:21.350841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9cc8e24-7465-4ff0-b4f0-bb20fa2815e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7b903b080>]}
[0m17:35:21.446083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9cc8e24-7465-4ff0-b4f0-bb20fa2815e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7b903b710>]}
[0m17:35:21.448583 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:35:21.618903 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:35:21.790452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:21.791482 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m17:35:22.430863 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:35:22.431841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a9cc8e24-7465-4ff0-b4f0-bb20fa2815e6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7732f4500>]}
[0m17:35:22.519632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9cc8e24-7465-4ff0-b4f0-bb20fa2815e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa773064c50>]}
[0m17:35:22.741426 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:35:22.745546 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:35:22.789614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9cc8e24-7465-4ff0-b4f0-bb20fa2815e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7730fd910>]}
[0m17:35:22.791882 [info ] [MainThread]: Found 2 models, 17 data tests, 470 macros
[0m17:35:22.793228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9cc8e24-7465-4ff0-b4f0-bb20fa2815e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa773009610>]}
[0m17:35:22.798572 [info ] [MainThread]: 
[0m17:35:22.800190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:35:22.801107 [info ] [MainThread]: 
[0m17:35:22.802052 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:22.808056 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m17:35:22.873995 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:35:22.874962 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m17:35:22.875520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:22.902750 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:35:22.903460 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:35:22.903910 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m17:35:22.930570 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m17:35:22.932508 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m17:35:22.934407 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m17:35:22.934987 [debug] [ThreadPool]: On list_medallion_main: Close
[0m17:35:22.936166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9cc8e24-7465-4ff0-b4f0-bb20fa2815e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa773027260>]}
[0m17:35:22.937061 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:22.937616 [debug] [MainThread]: On master: BEGIN
[0m17:35:22.938132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:22.939819 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:35:22.940410 [debug] [MainThread]: On master: COMMIT
[0m17:35:22.941076 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:22.941593 [debug] [MainThread]: On master: COMMIT
[0m17:35:22.943127 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:22.943728 [debug] [MainThread]: On master: Close
[0m17:35:22.949937 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:22.950716 [debug] [Thread-2 (]: Began running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:22.951400 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:22.951917 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:22.952578 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m17:35:22.953527 [info ] [Thread-2 (]: 2 of 17 START test id_valido_fct_customer_transactions_customer_id ............. [RUN]
[0m17:35:22.954274 [info ] [Thread-3 (]: 3 of 17 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m17:35:22.955007 [info ] [Thread-4 (]: 4 of 17 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m17:35:22.955971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m17:35:22.957120 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:35:22.958652 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:35:22.959695 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:35:22.961184 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:22.963001 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:22.964993 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:22.966320 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:22.978874 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:22.986631 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:22.992240 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:22.997214 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:23.000991 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:23.001919 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:23.002974 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:23.009995 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:23.058838 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:23.060041 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:23.063600 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:23.069185 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:23.073745 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:23.075516 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:23.076148 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m17:35:23.076800 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:23.077463 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:23.078242 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m17:35:23.078855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:23.079769 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: BEGIN
[0m17:35:23.080863 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m17:35:23.081682 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:35:23.083923 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:35:23.084696 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:35:23.085220 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:35:23.086917 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:35:23.088034 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:23.088515 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:35:23.089332 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:23.089823 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:35:23.090455 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:35:23.091096 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:23.091705 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.092359 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:23.093547 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.094547 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.095403 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.096088 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:35:23.097161 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.098305 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.099035 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.099666 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.100283 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.101150 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m17:35:23.101919 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.102724 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m17:35:23.103504 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: ROLLBACK
[0m17:35:23.106045 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m17:35:23.137909 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:35:23.139765 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:35:23.142116 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m17:35:23.143697 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:35:23.144430 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: Close
[0m17:35:23.145435 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m17:35:23.146076 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m17:35:23.146746 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m17:35:23.155300 [debug] [Thread-4 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.161851 [debug] [Thread-2 (]: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:35:23.159601 [error] [Thread-4 (]: 4 of 17 ERROR non_negative_fct_customer_transactions_total_amount_completed .... [[31mERROR[0m in 0.20s]
[0m17:35:23.165221 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:35:23.168016 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.169326 [error] [Thread-2 (]: 2 of 17 ERROR id_valido_fct_customer_transactions_customer_id .................. [[31mERROR[0m in 0.21s]
[0m17:35:23.170978 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:23.171922 [error] [Thread-1 (]: 1 of 17 ERROR accepted_values_stg_transactions_status__completed__pending__failed  [[31mERROR[0m in 0.22s]
[0m17:35:23.173024 [error] [Thread-3 (]: 3 of 17 ERROR non_negative_fct_customer_transactions_total_amount_all .......... [[31mERROR[0m in 0.21s]
[0m17:35:23.174154 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:23.174858 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:23.175838 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:23.176816 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:23.177681 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:23.178338 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:23.178982 [info ] [Thread-4 (]: 5 of 17 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m17:35:23.182145 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad' to be skipped because of status 'error'.  Reason: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^.
[0m17:35:23.183067 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:23.183815 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:23.184535 [info ] [Thread-2 (]: 6 of 17 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m17:35:23.185478 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4)
[0m17:35:23.186344 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26' to be skipped because of status 'error'.  Reason: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^.
[0m17:35:23.186999 [info ] [Thread-1 (]: 7 of 17 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m17:35:23.187868 [info ] [Thread-3 (]: 8 of 17 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m17:35:23.188794 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m17:35:23.189697 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:23.190632 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:23.191390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m17:35:23.192053 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m17:35:23.192755 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:23.198525 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:23.199686 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:23.200487 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:23.206635 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:23.222757 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:23.229371 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:23.230528 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:23.234483 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:23.235793 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:23.236504 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:23.241487 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:23.242143 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:23.243669 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:23.247511 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:23.252362 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:23.253736 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m17:35:23.254762 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:23.256454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:23.257203 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:23.257842 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:23.258443 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m17:35:23.259558 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m17:35:23.260281 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m17:35:23.260851 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:35:23.261445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:23.261992 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:35:23.262584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:23.263191 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:23.265279 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:35:23.266350 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:35:23.267222 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:35:23.267916 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.268704 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:23.269554 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:23.270285 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:23.271609 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.272356 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.272973 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.273617 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.274628 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.275362 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.276871 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m17:35:23.277511 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:35:23.278290 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.278968 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.281371 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.283483 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m17:35:23.284264 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m17:35:23.285040 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.285808 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m17:35:23.286466 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m17:35:23.289039 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m17:35:23.293457 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m17:35:23.300371 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m17:35:23.302280 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m17:35:23.305094 [debug] [Thread-4 (]: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.306770 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m17:35:23.307310 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m17:35:23.309317 [error] [Thread-4 (]: 5 of 17 ERROR non_negative_fct_customer_transactions_transaction_count ......... [[31mERROR[0m in 0.12s]
[0m17:35:23.310686 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m17:35:23.312579 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.314912 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:23.316688 [debug] [Thread-2 (]: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.318790 [error] [Thread-1 (]: 7 of 17 ERROR not_null_fct_customer_transactions_customer_id ................... [[31mERROR[0m in 0.13s]
[0m17:35:23.321362 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.322268 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:23.323077 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:23.323863 [error] [Thread-2 (]: 6 of 17 ERROR non_negative_stg_transactions_amount ............................. [[31mERROR[0m in 0.14s]
[0m17:35:23.324888 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:23.325713 [error] [Thread-3 (]: 8 of 17 ERROR not_null_fct_customer_transactions_total_amount_all .............. [[31mERROR[0m in 0.13s]
[0m17:35:23.326549 [info ] [Thread-4 (]: 9 of 17 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m17:35:23.327790 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:23.328505 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:23.329302 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:23.331102 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:23.331809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m17:35:23.332477 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:23.333197 [info ] [Thread-1 (]: 10 of 17 START test not_null_fct_customer_transactions_transaction_count ....... [RUN]
[0m17:35:23.334091 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:23.334792 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:23.335478 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:23.336532 [info ] [Thread-2 (]: 11 of 17 START test not_null_stg_transactions_amount ........................... [RUN]
[0m17:35:23.338069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m17:35:23.339308 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:23.340234 [info ] [Thread-3 (]: 12 of 17 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m17:35:23.346430 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:23.347979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m17:35:23.349044 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:23.350330 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m17:35:23.351310 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:23.355979 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:23.356796 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:23.357387 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:23.361769 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:23.364796 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:23.369443 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:23.370717 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:23.372234 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:23.375457 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:23.376969 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:23.377934 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:23.381193 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:23.382843 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m17:35:23.386022 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:23.388062 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:23.389407 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:23.391283 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:23.392201 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m17:35:23.392957 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:23.393968 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m17:35:23.394701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:23.395357 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:35:23.395890 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m17:35:23.396512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:35:23.397801 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:23.398498 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:35:23.399015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:23.400070 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.400821 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:23.401614 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:35:23.403348 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.403866 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:35:23.404573 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.405216 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:23.406415 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:23.407215 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.407951 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.408504 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.409344 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.412266 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m17:35:23.413129 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.414657 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.417397 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.419112 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m17:35:23.420887 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m17:35:23.421707 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.422451 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.424576 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m17:35:23.425686 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m17:35:23.427138 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m17:35:23.427916 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m17:35:23.431654 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m17:35:23.433935 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.437547 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m17:35:23.439810 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m17:35:23.442003 [error] [Thread-4 (]: 9 of 17 ERROR not_null_fct_customer_transactions_total_amount_completed ........ [[31mERROR[0m in 0.11s]
[0m17:35:23.443494 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m17:35:23.445157 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.445961 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m17:35:23.446958 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:23.448926 [error] [Thread-1 (]: 10 of 17 ERROR not_null_fct_customer_transactions_transaction_count ............ [[31mERROR[0m in 0.11s]
[0m17:35:23.451061 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.453046 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:23.454014 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:23.455350 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:23.456957 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.457834 [error] [Thread-2 (]: 11 of 17 ERROR not_null_stg_transactions_amount ................................ [[31mERROR[0m in 0.11s]
[0m17:35:23.458703 [info ] [Thread-4 (]: 13 of 17 START test not_null_stg_transactions_status ........................... [RUN]
[0m17:35:23.459851 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:23.460559 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:23.461261 [error] [Thread-3 (]: 12 of 17 ERROR not_null_stg_transactions_customer_id ........................... [[31mERROR[0m in 0.11s]
[0m17:35:23.462134 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:23.462792 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m17:35:23.463537 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m17:35:23.464892 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:23.465680 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:23.466475 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:23.467027 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:23.467672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m17:35:23.468335 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:23.469241 [info ] [Thread-2 (]: 15 of 17 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m17:35:23.470305 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:23.475307 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:23.476051 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:23.476791 [info ] [Thread-3 (]: 16 of 17 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m17:35:23.477731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m17:35:23.483131 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:23.484064 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m17:35:23.485033 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:23.485760 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:23.487195 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:23.490031 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:23.490999 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:23.495647 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:23.500844 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:23.504129 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:23.506278 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:23.507319 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:23.508342 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m17:35:23.509294 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:23.511928 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:23.512532 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:23.513304 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:23.516526 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:23.517943 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m17:35:23.519766 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:23.522877 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m17:35:23.521700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:23.522240 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:23.521060 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:35:23.523390 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:23.524323 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m17:35:23.525032 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:23.525508 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:35:23.526373 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:35:23.526973 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:35:23.527472 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.528057 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:23.529580 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:23.531040 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:35:23.532142 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.532946 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.533521 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.534377 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:23.535712 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.536568 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.537833 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.538657 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.539539 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m17:35:23.540438 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.541828 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.542826 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:23.545885 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m17:35:23.548283 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m17:35:23.550801 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m17:35:23.552250 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.554950 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m17:35:23.558474 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m17:35:23.559726 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m17:35:23.561369 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m17:35:23.563161 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m17:35:23.568590 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.570739 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m17:35:23.572581 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m17:35:23.574882 [error] [Thread-4 (]: 13 of 17 ERROR not_null_stg_transactions_status ................................ [[31mERROR[0m in 0.11s]
[0m17:35:23.577154 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.579151 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m17:35:23.580177 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:23.582313 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.583439 [error] [Thread-1 (]: 14 of 17 ERROR not_null_stg_transactions_transaction_date ...................... [[31mERROR[0m in 0.12s]
[0m17:35:23.586367 [debug] [Thread-4 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:23.587672 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:23.590140 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.591997 [error] [Thread-3 (]: 16 of 17 ERROR not_null_stg_transactions_transaction_ts ........................ [[31mERROR[0m in 0.11s]
[0m17:35:23.593699 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:23.594635 [info ] [Thread-4 (]: 17 of 17 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m17:35:23.596193 [error] [Thread-2 (]: 15 of 17 ERROR not_null_stg_transactions_transaction_id ........................ [[31mERROR[0m in 0.12s]
[0m17:35:23.597516 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:23.598955 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m17:35:23.600270 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:23.601672 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:23.603103 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:23.604942 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:23.615347 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:23.616953 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:23.618788 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:23.621899 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:23.623410 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:23.624047 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m17:35:23.624563 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:23.626043 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:35:23.626616 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:23.627113 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:35:23.628176 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:35:23.628780 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:23.629564 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m17:35:23.634152 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m17:35:23.635238 [debug] [Thread-4 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m17:35:23.638799 [debug] [Thread-4 (]: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.640142 [error] [Thread-4 (]: 17 of 17 ERROR unique_stg_transactions_transaction_id .......................... [[31mERROR[0m in 0.04s]
[0m17:35:23.641460 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:23.642430 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:23.645588 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:23.646544 [debug] [MainThread]: On master: BEGIN
[0m17:35:23.647323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:23.649212 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:35:23.649789 [debug] [MainThread]: On master: COMMIT
[0m17:35:23.650291 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:23.650774 [debug] [MainThread]: On master: COMMIT
[0m17:35:23.651887 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:23.652413 [debug] [MainThread]: On master: Close
[0m17:35:23.653128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:23.653623 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m17:35:23.654024 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m17:35:23.654418 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m17:35:23.654814 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m17:35:23.655315 [info ] [MainThread]: 
[0m17:35:23.655882 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m17:35:23.659452 [debug] [MainThread]: Command end result
[0m17:35:23.697835 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:35:23.700282 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:35:23.709016 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/run_results.json
[0m17:35:23.709698 [info ] [MainThread]: 
[0m17:35:23.710510 [info ] [MainThread]: [31mCompleted with 17 errors, 0 partial successes, and 0 warnings:[0m
[0m17:35:23.711238 [info ] [MainThread]: 
[0m17:35:23.711860 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:35:23.712432 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.712985 [info ] [MainThread]: 
[0m17:35:23.713606 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_completed.sql
[0m17:35:23.714101 [info ] [MainThread]: 
[0m17:35:23.714648 [error] [MainThread]: [31mFailure in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:35:23.715204 [error] [MainThread]:   Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:35:23.715687 [info ] [MainThread]: 
[0m17:35:23.716212 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/id_valido_fct_customer_transactions_customer_id.sql
[0m17:35:23.716724 [info ] [MainThread]: 
[0m17:35:23.717295 [error] [MainThread]: [31mFailure in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)[0m
[0m17:35:23.717831 [error] [MainThread]:   Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:35:23.718281 [info ] [MainThread]: 
[0m17:35:23.718809 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/accepted_values_stg_transactio_5bdf616555c30e299c6e421df7d58f81.sql
[0m17:35:23.719313 [info ] [MainThread]: 
[0m17:35:23.719847 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:35:23.720467 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.721186 [info ] [MainThread]: 
[0m17:35:23.721876 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_all.sql
[0m17:35:23.722390 [info ] [MainThread]: 
[0m17:35:23.722979 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:35:23.723701 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.724225 [info ] [MainThread]: 
[0m17:35:23.724860 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_transaction_count.sql
[0m17:35:23.725407 [info ] [MainThread]: 
[0m17:35:23.726052 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:35:23.727318 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.728435 [info ] [MainThread]: 
[0m17:35:23.729418 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_customer_id.sql
[0m17:35:23.730073 [info ] [MainThread]: 
[0m17:35:23.730751 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:35:23.731375 [error] [MainThread]:   Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.731850 [info ] [MainThread]: 
[0m17:35:23.732386 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/non_negative_stg_transactions_amount.sql
[0m17:35:23.732917 [info ] [MainThread]: 
[0m17:35:23.733487 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:35:23.734012 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.734463 [info ] [MainThread]: 
[0m17:35:23.734986 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_all.sql
[0m17:35:23.735457 [info ] [MainThread]: 
[0m17:35:23.735981 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:35:23.736500 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.737039 [info ] [MainThread]: 
[0m17:35:23.737624 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_completed.sql
[0m17:35:23.738087 [info ] [MainThread]: 
[0m17:35:23.738625 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:35:23.739256 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:23.739725 [info ] [MainThread]: 
[0m17:35:23.740255 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_transaction_count.sql
[0m17:35:23.740756 [info ] [MainThread]: 
[0m17:35:23.741449 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:35:23.742311 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.742868 [info ] [MainThread]: 
[0m17:35:23.743542 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_amount.sql
[0m17:35:23.744101 [info ] [MainThread]: 
[0m17:35:23.744765 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_customer_id (models/staging/schema.yml)[0m
[0m17:35:23.745367 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.745845 [info ] [MainThread]: 
[0m17:35:23.746474 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_customer_id.sql
[0m17:35:23.747126 [info ] [MainThread]: 
[0m17:35:23.747804 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_status (models/staging/schema.yml)[0m
[0m17:35:23.748372 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.748961 [info ] [MainThread]: 
[0m17:35:23.749552 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_status.sql
[0m17:35:23.750048 [info ] [MainThread]: 
[0m17:35:23.750625 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)[0m
[0m17:35:23.751204 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.751704 [info ] [MainThread]: 
[0m17:35:23.752222 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_date.sql
[0m17:35:23.752729 [info ] [MainThread]: 
[0m17:35:23.753299 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)[0m
[0m17:35:23.753842 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.754302 [info ] [MainThread]: 
[0m17:35:23.754816 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_ts.sql
[0m17:35:23.755288 [info ] [MainThread]: 
[0m17:35:23.755833 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:35:23.756374 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.756903 [info ] [MainThread]: 
[0m17:35:23.757557 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_id.sql
[0m17:35:23.758078 [info ] [MainThread]: 
[0m17:35:23.758610 [error] [MainThread]: [31mFailure in test unique_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:35:23.759142 [error] [MainThread]:   Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:23.759632 [info ] [MainThread]: 
[0m17:35:23.760155 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/unique_stg_transactions_transaction_id.sql
[0m17:35:23.760636 [info ] [MainThread]: 
[0m17:35:23.761142 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=17 SKIP=0 NO-OP=0 TOTAL=17
[0m17:35:23.761882 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:35:23.763132 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.9834168, "process_in_blocks": "0", "process_kernel_time": 1.032649, "process_mem_max_rss": "159592", "process_out_blocks": "3672", "process_user_time": 4.648917}
[0m17:35:23.763803 [debug] [MainThread]: Command `dbt test` failed at 17:35:23.763668 after 2.98 seconds
[0m17:35:23.764296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7ba3b7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7b9d24350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa7b9d25370>]}
[0m17:35:23.765582 [debug] [MainThread]: Flushing usage events
[0m17:35:24.549792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:34.440953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89693b27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8968a0a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89691170b0>]}


============================== 17:35:34.450414 | 1f893717-573d-4cbb-9b6b-3f56644e1047 ==============================
[0m17:35:34.450414 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:35:34.452991 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/profiles', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --project-dir /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_path': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/logs', 'log_cache_events': 'False', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'empty': 'None', 'log_format': 'default'}
[0m17:35:35.003369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f893717-573d-4cbb-9b6b-3f56644e1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8968f51670>]}
[0m17:35:35.115526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f893717-573d-4cbb-9b6b-3f56644e1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8967f656a0>]}
[0m17:35:35.119463 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:35:35.330876 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:35:35.495093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:35.497452 [debug] [MainThread]: Partial parsing: updated file: medallion_dbt://models/staging/stg_transactions.sql
[0m17:35:36.161426 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:35:36.162387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1f893717-573d-4cbb-9b6b-3f56644e1047', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e892e310980>]}
[0m17:35:36.268907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f893717-573d-4cbb-9b6b-3f56644e1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e892e219820>]}
[0m17:35:36.500860 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:35:36.503384 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:35:36.540027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f893717-573d-4cbb-9b6b-3f56644e1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e892e3c1e80>]}
[0m17:35:36.540918 [info ] [MainThread]: Found 2 models, 17 data tests, 470 macros
[0m17:35:36.541689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f893717-573d-4cbb-9b6b-3f56644e1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e892e28bcb0>]}
[0m17:35:36.547143 [info ] [MainThread]: 
[0m17:35:36.547953 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:35:36.548463 [info ] [MainThread]: 
[0m17:35:36.549306 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:36.555036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m17:35:36.615710 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:35:36.616278 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m17:35:36.616723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:36.647471 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m17:35:36.648177 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:35:36.648724 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m17:35:36.672814 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m17:35:36.674662 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m17:35:36.676155 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m17:35:36.676740 [debug] [ThreadPool]: On list_medallion_main: Close
[0m17:35:36.677994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f893717-573d-4cbb-9b6b-3f56644e1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e896a9a8470>]}
[0m17:35:36.678729 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:36.679197 [debug] [MainThread]: On master: BEGIN
[0m17:35:36.679650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:36.681089 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:36.681564 [debug] [MainThread]: On master: COMMIT
[0m17:35:36.681988 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:36.682400 [debug] [MainThread]: On master: COMMIT
[0m17:35:36.683543 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:36.683986 [debug] [MainThread]: On master: Close
[0m17:35:36.689468 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:36.690535 [debug] [Thread-2 (]: Began running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:36.691823 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:36.693613 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:36.692949 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m17:35:36.694729 [info ] [Thread-2 (]: 2 of 17 START test id_valido_fct_customer_transactions_customer_id ............. [RUN]
[0m17:35:36.696312 [info ] [Thread-3 (]: 3 of 17 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m17:35:36.699480 [info ] [Thread-4 (]: 4 of 17 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m17:35:36.701689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m17:35:36.702895 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:35:36.703890 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:35:36.704803 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:35:36.705585 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:36.706550 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:36.707294 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:36.707967 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:36.720490 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:36.726533 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:36.732094 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:36.739045 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:36.742718 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:36.744356 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:36.745138 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:36.774909 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:36.784149 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:36.788861 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:36.791636 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:36.795225 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:36.800510 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:36.801374 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:36.802064 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:36.802782 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m17:35:36.803368 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:36.804117 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m17:35:36.804923 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: BEGIN
[0m17:35:36.805644 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:35:36.806304 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m17:35:36.807106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:36.807698 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:35:36.808999 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:35:36.810082 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:35:36.811233 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:35:36.812355 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:35:36.813013 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:35:36.813716 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:35:36.814247 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:35:36.814892 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:35:36.815599 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:35:36.816262 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:35:36.817045 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:35:36.817831 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:35:36.819949 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:35:36.822827 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:35:36.825280 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:35:36.826344 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:35:36.828075 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:36.829032 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:35:36.829714 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:36.830384 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:36.831171 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m17:35:36.831863 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:36.832758 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: ROLLBACK
[0m17:35:36.833578 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m17:35:36.836290 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m17:35:36.866909 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:35:36.870478 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:35:36.871845 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m17:35:36.874219 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m17:35:36.875043 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: Close
[0m17:35:36.877290 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:35:36.880022 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m17:35:36.881978 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:36.883998 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m17:35:36.886470 [debug] [Thread-2 (]: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:35:36.888818 [error] [Thread-3 (]: 3 of 17 ERROR non_negative_fct_customer_transactions_total_amount_all .......... [[31mERROR[0m in 0.18s]
[0m17:35:36.892545 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:35:36.895404 [debug] [Thread-4 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:36.893820 [error] [Thread-2 (]: 2 of 17 ERROR id_valido_fct_customer_transactions_customer_id .................. [[31mERROR[0m in 0.19s]
[0m17:35:36.896916 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:35:36.897762 [error] [Thread-1 (]: 1 of 17 ERROR accepted_values_stg_transactions_status__completed__pending__failed  [[31mERROR[0m in 0.20s]
[0m17:35:36.898770 [error] [Thread-4 (]: 4 of 17 ERROR non_negative_fct_customer_transactions_total_amount_completed .... [[31mERROR[0m in 0.19s]
[0m17:35:36.899788 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:35:36.900548 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:36.901822 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:36.902925 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:35:36.903976 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:35:36.905093 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:36.906585 [info ] [Thread-3 (]: 5 of 17 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m17:35:36.914907 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad' to be skipped because of status 'error'.  Reason: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^.
[0m17:35:36.917154 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:36.918752 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:36.919684 [info ] [Thread-2 (]: 6 of 17 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m17:35:36.920860 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4)
[0m17:35:36.922216 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26' to be skipped because of status 'error'.  Reason: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^.
[0m17:35:36.923341 [info ] [Thread-1 (]: 7 of 17 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m17:35:36.924408 [info ] [Thread-4 (]: 8 of 17 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m17:35:36.925495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m17:35:36.926491 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:36.927643 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:36.928436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m17:35:36.929348 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m17:35:36.930229 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:36.936102 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:36.938090 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:36.939628 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:36.948014 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:36.962211 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:36.963438 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:36.971230 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:36.976566 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:36.979047 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:36.980385 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:36.987112 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:36.993772 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:36.996203 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:36.998821 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:37.001567 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:37.007046 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:37.008743 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:37.009816 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m17:35:37.010599 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m17:35:37.011994 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m17:35:37.012924 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:37.013922 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:37.014555 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:35:37.015540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:37.017222 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m17:35:37.018430 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:35:37.021043 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:35:37.022183 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:37.023355 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:35:37.024219 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:35:37.025177 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:35:37.027043 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:35:37.027951 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:35:37.028842 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:35:37.030372 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:35:37.031674 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.033415 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:35:37.036159 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:35:37.037825 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:35:37.039125 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.040016 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.040592 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.041590 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.043312 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.044543 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.046187 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m17:35:37.047381 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m17:35:37.048178 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m17:35:37.048853 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.057930 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m17:35:37.060234 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m17:35:37.064156 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m17:35:37.067771 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m17:35:37.068772 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m17:35:37.072025 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m17:35:37.073085 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m17:35:37.075962 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m17:35:37.082790 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.087428 [debug] [Thread-2 (]: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.088582 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m17:35:37.090380 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.092803 [error] [Thread-3 (]: 5 of 17 ERROR non_negative_fct_customer_transactions_transaction_count ......... [[31mERROR[0m in 0.17s]
[0m17:35:37.095942 [error] [Thread-2 (]: 6 of 17 ERROR non_negative_stg_transactions_amount ............................. [[31mERROR[0m in 0.17s]
[0m17:35:37.099972 [error] [Thread-1 (]: 7 of 17 ERROR not_null_fct_customer_transactions_customer_id ................... [[31mERROR[0m in 0.17s]
[0m17:35:37.101571 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:35:37.102829 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:35:37.104377 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.105602 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:35:37.106696 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:37.107535 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:37.108153 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:37.109104 [error] [Thread-4 (]: 8 of 17 ERROR not_null_fct_customer_transactions_total_amount_all .............. [[31mERROR[0m in 0.18s]
[0m17:35:37.110354 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:37.111164 [info ] [Thread-3 (]: 9 of 17 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m17:35:37.112193 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:37.112969 [info ] [Thread-2 (]: 10 of 17 START test not_null_fct_customer_transactions_transaction_count ....... [RUN]
[0m17:35:37.113935 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:35:37.114659 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_transactions_amount ........................... [RUN]
[0m17:35:37.115675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m17:35:37.116684 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:37.117433 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m17:35:37.118139 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:37.118792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m17:35:37.119468 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:37.120320 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:37.121013 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:37.121734 [info ] [Thread-4 (]: 12 of 17 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m17:35:37.122685 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:37.132852 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:37.140205 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:37.141220 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m17:35:37.147010 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:37.148537 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:37.149213 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:37.149842 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:37.154334 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:37.158567 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:37.159824 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:37.163985 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:37.169158 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:37.170088 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:37.172128 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:37.175254 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:37.176430 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:37.177530 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:37.178149 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m17:35:37.179025 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m17:35:37.179736 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m17:35:37.180302 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:37.181044 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:37.181857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:37.182466 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:35:37.183132 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m17:35:37.184982 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:35:37.185641 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:35:37.186769 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:37.187374 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:35:37.188026 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:35:37.188926 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:35:37.190039 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:35:37.190846 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.191439 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:35:37.192282 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.193723 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.196017 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:35:37.199118 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.202540 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.203506 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.204169 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.205270 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.205981 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.206585 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.207713 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m17:35:37.208441 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.209348 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m17:35:37.210086 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m17:35:37.212323 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.213970 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m17:35:37.219036 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m17:35:37.221503 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m17:35:37.222584 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m17:35:37.223243 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m17:35:37.224001 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m17:35:37.225344 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m17:35:37.232873 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m17:35:37.242013 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.243860 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m17:35:37.245916 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.247482 [error] [Thread-3 (]: 9 of 17 ERROR not_null_fct_customer_transactions_total_amount_completed ........ [[31mERROR[0m in 0.13s]
[0m17:35:37.249830 [debug] [Thread-2 (]: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.252206 [error] [Thread-1 (]: 11 of 17 ERROR not_null_stg_transactions_amount ................................ [[31mERROR[0m in 0.13s]
[0m17:35:37.253759 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:35:37.255403 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.256395 [error] [Thread-2 (]: 10 of 17 ERROR not_null_fct_customer_transactions_transaction_count ............ [[31mERROR[0m in 0.14s]
[0m17:35:37.257615 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:35:37.258418 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:37.259361 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:37.260134 [error] [Thread-4 (]: 12 of 17 ERROR not_null_stg_transactions_customer_id ........................... [[31mERROR[0m in 0.12s]
[0m17:35:37.261284 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:35:37.262233 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:37.263080 [info ] [Thread-3 (]: 13 of 17 START test not_null_stg_transactions_status ........................... [RUN]
[0m17:35:37.264172 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:37.265150 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:35:37.266086 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:37.266820 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m17:35:37.267681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m17:35:37.268520 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:35:37.269309 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:37.270043 [info ] [Thread-2 (]: 15 of 17 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m17:35:37.271338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m17:35:37.272497 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:37.274154 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:37.275244 [info ] [Thread-4 (]: 16 of 17 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m17:35:37.277368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m17:35:37.278254 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:37.286790 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:37.288100 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m17:35:37.288764 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:37.294153 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:37.295328 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:37.300245 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:37.301097 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:37.307506 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:37.309008 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:37.312124 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:37.312949 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:37.316266 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:37.319552 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:37.320400 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:37.321402 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:37.324490 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:37.326054 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:37.327001 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m17:35:37.327704 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:37.328561 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m17:35:37.329321 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:37.329890 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:37.330498 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m17:35:37.331068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:37.332057 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m17:35:37.332783 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:35:37.333344 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:35:37.334321 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:35:37.334914 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:35:37.335877 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:35:37.336458 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:35:37.337509 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:35:37.338318 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:35:37.338987 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.339653 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:35:37.340308 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.340992 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:35:37.342446 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.343475 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.344779 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.345524 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.346867 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.347814 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.349539 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.350565 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:35:37.351409 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m17:35:37.352194 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.353060 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m17:35:37.353686 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.356238 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m17:35:37.358053 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m17:35:37.360595 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m17:35:37.364291 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m17:35:37.366336 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m17:35:37.366953 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m17:35:37.369744 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m17:35:37.371811 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m17:35:37.372385 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m17:35:37.376866 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m17:35:37.378870 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.381178 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.389714 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.387519 [error] [Thread-3 (]: 13 of 17 ERROR not_null_stg_transactions_status ................................ [[31mERROR[0m in 0.12s]
[0m17:35:37.391719 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.392739 [error] [Thread-1 (]: 14 of 17 ERROR not_null_stg_transactions_transaction_date ...................... [[31mERROR[0m in 0.12s]
[0m17:35:37.393621 [error] [Thread-2 (]: 15 of 17 ERROR not_null_stg_transactions_transaction_id ........................ [[31mERROR[0m in 0.12s]
[0m17:35:37.394543 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:35:37.395242 [error] [Thread-4 (]: 16 of 17 ERROR not_null_stg_transactions_transaction_ts ........................ [[31mERROR[0m in 0.11s]
[0m17:35:37.396275 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:35:37.397934 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:35:37.398851 [debug] [Thread-3 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:37.399682 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:37.400452 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:35:37.401484 [info ] [Thread-3 (]: 17 of 17 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m17:35:37.402470 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:37.403320 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m17:35:37.404057 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:37.404688 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:37.405482 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:37.413846 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:37.415514 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:37.418721 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:37.419714 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:37.420295 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m17:35:37.420833 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:35:37.422043 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:35:37.422548 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:35:37.423037 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:35:37.424027 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:35:37.424787 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:35:37.426155 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m17:35:37.429846 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m17:35:37.430422 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m17:35:37.433645 [debug] [Thread-3 (]: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.434938 [error] [Thread-3 (]: 17 of 17 ERROR unique_stg_transactions_transaction_id .......................... [[31mERROR[0m in 0.03s]
[0m17:35:37.435962 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:35:37.436846 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^.
[0m17:35:37.439845 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:37.440418 [debug] [MainThread]: On master: BEGIN
[0m17:35:37.441001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:37.442507 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:37.443069 [debug] [MainThread]: On master: COMMIT
[0m17:35:37.443512 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:37.443961 [debug] [MainThread]: On master: COMMIT
[0m17:35:37.445295 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:37.445820 [debug] [MainThread]: On master: Close
[0m17:35:37.446404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:37.446839 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m17:35:37.447247 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m17:35:37.447624 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m17:35:37.448050 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m17:35:37.448502 [info ] [MainThread]: 
[0m17:35:37.449064 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m17:35:37.452027 [debug] [MainThread]: Command end result
[0m17:35:37.482689 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:35:37.485123 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:35:37.493423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/run_results.json
[0m17:35:37.494127 [info ] [MainThread]: 
[0m17:35:37.494775 [info ] [MainThread]: [31mCompleted with 17 errors, 0 partial successes, and 0 warnings:[0m
[0m17:35:37.495312 [info ] [MainThread]: 
[0m17:35:37.496082 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:35:37.496750 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.497306 [info ] [MainThread]: 
[0m17:35:37.497927 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_all.sql
[0m17:35:37.498423 [info ] [MainThread]: 
[0m17:35:37.499007 [error] [MainThread]: [31mFailure in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:35:37.499558 [error] [MainThread]:   Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:35:37.500014 [info ] [MainThread]: 
[0m17:35:37.500537 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/id_valido_fct_customer_transactions_customer_id.sql
[0m17:35:37.501113 [info ] [MainThread]: 
[0m17:35:37.501727 [error] [MainThread]: [31mFailure in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)[0m
[0m17:35:37.502282 [error] [MainThread]:   Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:35:37.502760 [info ] [MainThread]: 
[0m17:35:37.503325 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/accepted_values_stg_transactio_5bdf616555c30e299c6e421df7d58f81.sql
[0m17:35:37.503943 [info ] [MainThread]: 
[0m17:35:37.504927 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:35:37.506087 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.506755 [info ] [MainThread]: 
[0m17:35:37.507389 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_completed.sql
[0m17:35:37.507936 [info ] [MainThread]: 
[0m17:35:37.508509 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:35:37.509157 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.509657 [info ] [MainThread]: 
[0m17:35:37.510225 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_transaction_count.sql
[0m17:35:37.510693 [info ] [MainThread]: 
[0m17:35:37.511227 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:35:37.511769 [error] [MainThread]:   Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.512212 [info ] [MainThread]: 
[0m17:35:37.512747 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/non_negative_stg_transactions_amount.sql
[0m17:35:37.513227 [info ] [MainThread]: 
[0m17:35:37.513779 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:35:37.514320 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.514775 [info ] [MainThread]: 
[0m17:35:37.515343 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_customer_id.sql
[0m17:35:37.515875 [info ] [MainThread]: 
[0m17:35:37.516403 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:35:37.517006 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.517482 [info ] [MainThread]: 
[0m17:35:37.518004 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_all.sql
[0m17:35:37.518459 [info ] [MainThread]: 
[0m17:35:37.519062 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:35:37.519682 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.520150 [info ] [MainThread]: 
[0m17:35:37.520746 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_completed.sql
[0m17:35:37.521220 [info ] [MainThread]: 
[0m17:35:37.521767 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:35:37.522285 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.522727 [info ] [MainThread]: 
[0m17:35:37.523267 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_amount.sql
[0m17:35:37.523766 [info ] [MainThread]: 
[0m17:35:37.524494 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:35:37.525232 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:35:37.525800 [info ] [MainThread]: 
[0m17:35:37.526376 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_transaction_count.sql
[0m17:35:37.526871 [info ] [MainThread]: 
[0m17:35:37.527425 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_customer_id (models/staging/schema.yml)[0m
[0m17:35:37.528073 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.528660 [info ] [MainThread]: 
[0m17:35:37.529251 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_customer_id.sql
[0m17:35:37.529761 [info ] [MainThread]: 
[0m17:35:37.530315 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_status (models/staging/schema.yml)[0m
[0m17:35:37.530883 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.531342 [info ] [MainThread]: 
[0m17:35:37.531904 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_status.sql
[0m17:35:37.532367 [info ] [MainThread]: 
[0m17:35:37.532940 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)[0m
[0m17:35:37.533467 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.534071 [info ] [MainThread]: 
[0m17:35:37.534725 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_date.sql
[0m17:35:37.535273 [info ] [MainThread]: 
[0m17:35:37.535936 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:35:37.536523 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.537097 [info ] [MainThread]: 
[0m17:35:37.537651 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_id.sql
[0m17:35:37.538133 [info ] [MainThread]: 
[0m17:35:37.538663 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)[0m
[0m17:35:37.539185 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.539650 [info ] [MainThread]: 
[0m17:35:37.540168 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_ts.sql
[0m17:35:37.540653 [info ] [MainThread]: 
[0m17:35:37.541390 [error] [MainThread]: [31mFailure in test unique_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:35:37.542390 [error] [MainThread]:   Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:35:37.543140 [info ] [MainThread]: 
[0m17:35:37.544074 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/unique_stg_transactions_transaction_id.sql
[0m17:35:37.544656 [info ] [MainThread]: 
[0m17:35:37.545296 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=17 SKIP=0 NO-OP=0 TOTAL=17
[0m17:35:37.546096 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:35:37.547426 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.237346, "process_in_blocks": "0", "process_kernel_time": 1.066123, "process_mem_max_rss": "158952", "process_out_blocks": "3680", "process_user_time": 5.166292}
[0m17:35:37.548009 [debug] [MainThread]: Command `dbt test` failed at 17:35:37.547886 after 3.24 seconds
[0m17:35:37.548488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e89686c2c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e892e3edcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e896855ddc0>]}
[0m17:35:37.549082 [debug] [MainThread]: Flushing usage events
[0m17:35:38.320106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:11.664273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e26a6b0e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e26b17a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e26ac16e10>]}


============================== 17:36:11.670575 | 0c0cef61-5452-4727-80b0-5431485ca547 ==============================
[0m17:36:11.670575 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:36:11.671346 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/logs', 'use_colors': 'True', 'invocation_command': 'dbt test --project-dir /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'profiles_dir': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/profiles', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None'}
[0m17:36:12.081795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c0cef61-5452-4727-80b0-5431485ca547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e26b3955e0>]}
[0m17:36:12.178976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c0cef61-5452-4727-80b0-5431485ca547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e25e988470>]}
[0m17:36:12.181249 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:36:12.353799 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:36:12.532748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:12.533379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:12.589398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c0cef61-5452-4727-80b0-5431485ca547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e25e706b40>]}
[0m17:36:12.711206 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:36:12.713604 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:36:12.751215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c0cef61-5452-4727-80b0-5431485ca547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e25c4d0bc0>]}
[0m17:36:12.752034 [info ] [MainThread]: Found 2 models, 17 data tests, 470 macros
[0m17:36:12.752604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c0cef61-5452-4727-80b0-5431485ca547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e25e8d9130>]}
[0m17:36:12.756347 [info ] [MainThread]: 
[0m17:36:12.757726 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:36:12.759646 [info ] [MainThread]: 
[0m17:36:12.761493 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:36:12.770317 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m17:36:12.836071 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:36:12.838091 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m17:36:12.838604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:12.864112 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m17:36:12.864837 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:36:12.865525 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m17:36:12.893860 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m17:36:12.896040 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m17:36:12.897802 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m17:36:12.898493 [debug] [ThreadPool]: On list_medallion_main: Close
[0m17:36:12.899898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c0cef61-5452-4727-80b0-5431485ca547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e25e86c050>]}
[0m17:36:12.900964 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:12.901821 [debug] [MainThread]: On master: BEGIN
[0m17:36:12.902433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:12.904391 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:36:12.905334 [debug] [MainThread]: On master: COMMIT
[0m17:36:12.906123 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:12.906989 [debug] [MainThread]: On master: COMMIT
[0m17:36:12.909091 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:36:12.910253 [debug] [MainThread]: On master: Close
[0m17:36:12.919284 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:36:12.920216 [debug] [Thread-2 (]: Began running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:36:12.921076 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m17:36:12.922032 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:36:12.923388 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:36:12.924812 [info ] [Thread-2 (]: 2 of 17 START test id_valido_fct_customer_transactions_customer_id ............. [RUN]
[0m17:36:12.926459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m17:36:12.927970 [info ] [Thread-3 (]: 3 of 17 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m17:36:12.929093 [info ] [Thread-4 (]: 4 of 17 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m17:36:12.930235 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:36:12.930968 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:36:12.931895 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:36:12.932814 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:36:12.933582 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:36:12.955861 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:36:12.965515 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:36:12.966330 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:36:12.974196 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:36:12.986632 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:36:12.996069 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:36:12.997392 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:36:12.998726 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:36:13.025111 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:36:13.043009 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:36:13.047685 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:36:13.048679 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:36:13.051578 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:36:13.054972 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:36:13.057611 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:36:13.059524 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:36:13.060673 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m17:36:13.061971 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:36:13.064209 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:36:13.065939 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: BEGIN
[0m17:36:13.067714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:13.068902 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m17:36:13.070014 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m17:36:13.070919 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:36:13.072523 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:36:13.073837 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:36:13.074542 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:36:13.077730 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:36:13.078426 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:36:13.079066 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:36:13.080062 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:36:13.080811 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:36:13.081320 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:36:13.081933 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:36:13.082960 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:36:13.083690 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.084356 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.085185 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:36:13.085738 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.088776 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.090216 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.091187 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.092424 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.093530 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m17:36:13.094746 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.095936 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.097145 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: ROLLBACK
[0m17:36:13.100311 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.102567 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m17:36:13.109469 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m17:36:13.132213 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:36:13.134597 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m17:36:13.136344 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:36:13.137240 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m17:36:13.138789 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:36:13.139556 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m17:36:13.140320 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: Close
[0m17:36:13.143023 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m17:36:13.148965 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.155592 [debug] [Thread-2 (]: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:36:13.158191 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:36:13.160060 [error] [Thread-3 (]: 3 of 17 ERROR non_negative_fct_customer_transactions_total_amount_all .......... [[31mERROR[0m in 0.23s]
[0m17:36:13.161656 [error] [Thread-2 (]: 2 of 17 ERROR id_valido_fct_customer_transactions_customer_id .................. [[31mERROR[0m in 0.23s]
[0m17:36:13.164526 [debug] [Thread-4 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.163029 [error] [Thread-1 (]: 1 of 17 ERROR accepted_values_stg_transactions_status__completed__pending__failed  [[31mERROR[0m in 0.24s]
[0m17:36:13.165764 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:36:13.166613 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:36:13.167358 [error] [Thread-4 (]: 4 of 17 ERROR non_negative_fct_customer_transactions_total_amount_completed .... [[31mERROR[0m in 0.23s]
[0m17:36:13.168364 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:36:13.169298 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:36:13.170198 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:36:13.170785 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:36:13.171659 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:36:13.172300 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:36:13.173280 [info ] [Thread-3 (]: 5 of 17 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m17:36:13.175221 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad' to be skipped because of status 'error'.  Reason: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^.
[0m17:36:13.175893 [info ] [Thread-2 (]: 6 of 17 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m17:36:13.176729 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:36:13.177515 [info ] [Thread-1 (]: 7 of 17 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m17:36:13.178411 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4)
[0m17:36:13.179271 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26' to be skipped because of status 'error'.  Reason: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^.
[0m17:36:13.179894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m17:36:13.180498 [info ] [Thread-4 (]: 8 of 17 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m17:36:13.181300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m17:36:13.182143 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:36:13.183214 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:36:13.184524 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:36:13.185933 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m17:36:13.187439 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:36:13.195634 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:36:13.200581 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:36:13.201446 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:36:13.209681 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:36:13.215474 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:36:13.216192 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:36:13.217607 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:36:13.218932 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:36:13.222147 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:36:13.224347 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:36:13.232350 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:36:13.236506 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:36:13.239916 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:36:13.241124 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:36:13.242472 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:36:13.243498 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m17:36:13.244135 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:36:13.244795 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:36:13.245368 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m17:36:13.245989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:36:13.246684 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m17:36:13.247284 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m17:36:13.247896 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:36:13.248950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:13.249573 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:36:13.250086 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:36:13.252410 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:36:13.253491 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:36:13.254459 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:36:13.255110 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:36:13.255899 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:36:13.256883 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:36:13.257929 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:36:13.259044 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.259991 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.261556 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.262941 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.265183 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.266302 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:36:13.268126 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.268775 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.269300 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.269945 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.270632 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.271395 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.272198 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m17:36:13.273232 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m17:36:13.274338 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m17:36:13.275133 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m17:36:13.281629 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m17:36:13.286188 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m17:36:13.290013 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m17:36:13.290884 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m17:36:13.292974 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m17:36:13.293755 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m17:36:13.294409 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m17:36:13.296256 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m17:36:13.300355 [debug] [Thread-2 (]: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.303123 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.311653 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.313926 [error] [Thread-2 (]: 6 of 17 ERROR non_negative_stg_transactions_amount ............................. [[31mERROR[0m in 0.13s]
[0m17:36:13.316171 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.316965 [error] [Thread-3 (]: 5 of 17 ERROR non_negative_fct_customer_transactions_transaction_count ......... [[31mERROR[0m in 0.14s]
[0m17:36:13.318281 [error] [Thread-1 (]: 7 of 17 ERROR not_null_fct_customer_transactions_customer_id ................... [[31mERROR[0m in 0.14s]
[0m17:36:13.320573 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:36:13.322067 [error] [Thread-4 (]: 8 of 17 ERROR not_null_fct_customer_transactions_total_amount_all .............. [[31mERROR[0m in 0.14s]
[0m17:36:13.323500 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:36:13.324923 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:36:13.325852 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:36:13.326738 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^.
[0m17:36:13.327483 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:36:13.328196 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:36:13.329001 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:36:13.329725 [info ] [Thread-2 (]: 9 of 17 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m17:36:13.330682 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:36:13.331324 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:36:13.332019 [info ] [Thread-3 (]: 10 of 17 START test not_null_fct_customer_transactions_transaction_count ....... [RUN]
[0m17:36:13.332873 [info ] [Thread-1 (]: 11 of 17 START test not_null_stg_transactions_amount ........................... [RUN]
[0m17:36:13.334260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m17:36:13.335559 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:36:13.336920 [info ] [Thread-4 (]: 12 of 17 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m17:36:13.339475 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m17:36:13.341918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m17:36:13.343070 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:36:13.344785 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:36:13.345558 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m17:36:13.346222 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:36:13.346946 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:36:13.352458 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:36:13.353554 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:36:13.361417 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:36:13.465154 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:36:13.471017 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:36:13.472409 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:36:13.473799 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:36:13.477317 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:36:13.478062 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:36:13.478706 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:36:13.481155 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:36:13.483990 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:36:13.486693 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:36:13.487488 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:36:13.489798 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m17:36:13.491741 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:36:13.493790 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:36:13.495883 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:36:13.497729 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:36:13.498956 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m17:36:13.499737 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m17:36:13.500826 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m17:36:13.501501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:13.502059 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:36:13.502783 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:36:13.503492 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:36:13.504503 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:36:13.505634 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:36:13.506990 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.507662 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:36:13.508475 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:36:13.509407 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:36:13.510349 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:36:13.511045 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.511592 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.512266 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:36:13.513050 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.513847 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.514776 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.515428 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.516450 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m17:36:13.517276 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.518204 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.518900 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.521027 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.523352 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m17:36:13.524597 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m17:36:13.525462 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.526248 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m17:36:13.527209 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m17:36:13.531271 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m17:36:13.534180 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m17:36:13.545090 [debug] [Thread-2 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.545905 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m17:36:13.547596 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m17:36:13.550304 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m17:36:13.548791 [error] [Thread-2 (]: 9 of 17 ERROR not_null_fct_customer_transactions_total_amount_completed ........ [[31mERROR[0m in 0.21s]
[0m17:36:13.552527 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m17:36:13.554519 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.555048 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m17:36:13.555866 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:36:13.558678 [error] [Thread-1 (]: 11 of 17 ERROR not_null_stg_transactions_amount ................................ [[31mERROR[0m in 0.22s]
[0m17:36:13.561432 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.563585 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:36:13.564470 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:36:13.566786 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.568165 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:36:13.569739 [error] [Thread-3 (]: 10 of 17 ERROR not_null_fct_customer_transactions_transaction_count ............ [[31mERROR[0m in 0.23s]
[0m17:36:13.571099 [info ] [Thread-2 (]: 13 of 17 START test not_null_stg_transactions_status ........................... [RUN]
[0m17:36:13.572832 [error] [Thread-4 (]: 12 of 17 ERROR not_null_stg_transactions_customer_id ........................... [[31mERROR[0m in 0.23s]
[0m17:36:13.574166 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:36:13.575045 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:36:13.575975 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:36:13.576925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m17:36:13.578076 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:36:13.579039 [info ] [Thread-1 (]: 14 of 17 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m17:36:13.580296 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:36:13.581095 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:36:13.581628 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:36:13.582390 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:36:13.583091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m17:36:13.583734 [info ] [Thread-3 (]: 15 of 17 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m17:36:13.584799 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:36:13.590348 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:36:13.591452 [info ] [Thread-4 (]: 16 of 17 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m17:36:13.592494 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:36:13.593632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m17:36:13.594897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m17:36:13.600015 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:36:13.600869 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:36:13.601686 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:36:13.602528 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:36:13.605508 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:36:13.616965 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:36:13.616321 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:36:13.623955 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:36:13.627124 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:36:13.628500 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:36:13.629774 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:36:13.630576 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m17:36:13.631069 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:36:13.631746 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:36:13.634210 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:36:13.634900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:36:13.637973 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:36:13.638968 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m17:36:13.642083 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:36:13.643165 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:36:13.643966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:13.644930 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:36:13.645753 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:36:13.646335 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m17:36:13.648042 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.649378 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m17:36:13.650664 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:36:13.651488 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m17:36:13.653196 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:36:13.654082 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.655701 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:36:13.658307 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:36:13.659828 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.660914 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:36:13.662167 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.663022 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:36:13.663982 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m17:36:13.664762 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:36:13.666101 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.668358 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.669636 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.671156 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m17:36:13.672324 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.673227 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.674575 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m17:36:13.675312 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:36:13.676014 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m17:36:13.676682 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.678425 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.680240 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.684507 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m17:36:13.686062 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m17:36:13.687286 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m17:36:13.689353 [error] [Thread-2 (]: 13 of 17 ERROR not_null_stg_transactions_status ................................ [[31mERROR[0m in 0.11s]
[0m17:36:13.691968 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m17:36:13.699084 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:36:13.701741 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m17:36:13.703482 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m17:36:13.706016 [debug] [Thread-2 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:36:13.707124 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:36:13.708402 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m17:36:13.710016 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.710683 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m17:36:13.711449 [info ] [Thread-2 (]: 17 of 17 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m17:36:13.713860 [error] [Thread-1 (]: 14 of 17 ERROR not_null_stg_transactions_transaction_date ...................... [[31mERROR[0m in 0.13s]
[0m17:36:13.717110 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.717991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m17:36:13.720021 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.720918 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:36:13.721814 [error] [Thread-4 (]: 16 of 17 ERROR not_null_stg_transactions_transaction_ts ........................ [[31mERROR[0m in 0.13s]
[0m17:36:13.722978 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:36:13.724226 [error] [Thread-3 (]: 15 of 17 ERROR not_null_stg_transactions_transaction_id ........................ [[31mERROR[0m in 0.13s]
[0m17:36:13.726055 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:36:13.727220 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:36:13.738709 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:36:13.740055 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:36:13.741810 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:36:13.744176 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:36:13.744902 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:36:13.747916 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:36:13.749000 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:36:13.749856 [debug] [Thread-2 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m17:36:13.750568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:36:13.752331 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:36:13.753374 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:36:13.754029 [debug] [Thread-2 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:36:13.755305 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:36:13.756007 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:13.757080 [debug] [Thread-2 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m17:36:13.763473 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m17:36:13.764516 [debug] [Thread-2 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m17:36:13.768462 [debug] [Thread-2 (]: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.769549 [error] [Thread-2 (]: 17 of 17 ERROR unique_stg_transactions_transaction_id .......................... [[31mERROR[0m in 0.05s]
[0m17:36:13.770426 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:36:13.771290 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^.
[0m17:36:13.775074 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:13.776197 [debug] [MainThread]: On master: BEGIN
[0m17:36:13.777520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:13.779251 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:36:13.780056 [debug] [MainThread]: On master: COMMIT
[0m17:36:13.780501 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:13.781004 [debug] [MainThread]: On master: COMMIT
[0m17:36:13.782119 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:36:13.783123 [debug] [MainThread]: On master: Close
[0m17:36:13.784064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:13.784847 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m17:36:13.785476 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m17:36:13.786083 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m17:36:13.786635 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m17:36:13.787285 [info ] [MainThread]: 
[0m17:36:13.788020 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m17:36:13.792115 [debug] [MainThread]: Command end result
[0m17:36:13.828474 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:36:13.831089 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:36:13.839537 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/run_results.json
[0m17:36:13.840308 [info ] [MainThread]: 
[0m17:36:13.841233 [info ] [MainThread]: [31mCompleted with 17 errors, 0 partial successes, and 0 warnings:[0m
[0m17:36:13.841891 [info ] [MainThread]: 
[0m17:36:13.842506 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:36:13.843138 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.843654 [info ] [MainThread]: 
[0m17:36:13.844199 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_all.sql
[0m17:36:13.844699 [info ] [MainThread]: 
[0m17:36:13.845287 [error] [MainThread]: [31mFailure in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:36:13.845882 [error] [MainThread]:   Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:36:13.846441 [info ] [MainThread]: 
[0m17:36:13.847622 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/id_valido_fct_customer_transactions_customer_id.sql
[0m17:36:13.848750 [info ] [MainThread]: 
[0m17:36:13.849995 [error] [MainThread]: [31mFailure in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)[0m
[0m17:36:13.851124 [error] [MainThread]:   Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:36:13.851748 [info ] [MainThread]: 
[0m17:36:13.852426 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/accepted_values_stg_transactio_5bdf616555c30e299c6e421df7d58f81.sql
[0m17:36:13.853147 [info ] [MainThread]: 
[0m17:36:13.853741 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:36:13.854280 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.854733 [info ] [MainThread]: 
[0m17:36:13.855298 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_completed.sql
[0m17:36:13.855851 [info ] [MainThread]: 
[0m17:36:13.856732 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:36:13.857639 [error] [MainThread]:   Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.858348 [info ] [MainThread]: 
[0m17:36:13.859127 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/non_negative_stg_transactions_amount.sql
[0m17:36:13.859872 [info ] [MainThread]: 
[0m17:36:13.860559 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:36:13.861368 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.861995 [info ] [MainThread]: 
[0m17:36:13.862651 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_transaction_count.sql
[0m17:36:13.863234 [info ] [MainThread]: 
[0m17:36:13.863833 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:36:13.864439 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.864946 [info ] [MainThread]: 
[0m17:36:13.865469 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_customer_id.sql
[0m17:36:13.865971 [info ] [MainThread]: 
[0m17:36:13.866517 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:36:13.867049 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.867548 [info ] [MainThread]: 
[0m17:36:13.868138 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_all.sql
[0m17:36:13.868604 [info ] [MainThread]: 
[0m17:36:13.869170 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:36:13.869748 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.870194 [info ] [MainThread]: 
[0m17:36:13.870710 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_completed.sql
[0m17:36:13.871161 [info ] [MainThread]: 
[0m17:36:13.871886 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:36:13.872685 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.873345 [info ] [MainThread]: 
[0m17:36:13.874101 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_amount.sql
[0m17:36:13.874665 [info ] [MainThread]: 
[0m17:36:13.875353 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:36:13.875971 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:36:13.876430 [info ] [MainThread]: 
[0m17:36:13.877044 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_transaction_count.sql
[0m17:36:13.877532 [info ] [MainThread]: 
[0m17:36:13.878069 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_customer_id (models/staging/schema.yml)[0m
[0m17:36:13.878597 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.879061 [info ] [MainThread]: 
[0m17:36:13.879590 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_customer_id.sql
[0m17:36:13.880054 [info ] [MainThread]: 
[0m17:36:13.880603 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_status (models/staging/schema.yml)[0m
[0m17:36:13.881195 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.881670 [info ] [MainThread]: 
[0m17:36:13.882350 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_status.sql
[0m17:36:13.883379 [info ] [MainThread]: 
[0m17:36:13.883992 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)[0m
[0m17:36:13.884727 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.885338 [info ] [MainThread]: 
[0m17:36:13.885900 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_date.sql
[0m17:36:13.886585 [info ] [MainThread]: 
[0m17:36:13.887524 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)[0m
[0m17:36:13.888838 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.891025 [info ] [MainThread]: 
[0m17:36:13.892315 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_ts.sql
[0m17:36:13.893413 [info ] [MainThread]: 
[0m17:36:13.894413 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:36:13.895561 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.896676 [info ] [MainThread]: 
[0m17:36:13.897804 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_id.sql
[0m17:36:13.898672 [info ] [MainThread]: 
[0m17:36:13.899491 [error] [MainThread]: [31mFailure in test unique_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:36:13.900100 [error] [MainThread]:   Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:36:13.900574 [info ] [MainThread]: 
[0m17:36:13.901247 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/unique_stg_transactions_transaction_id.sql
[0m17:36:13.901811 [info ] [MainThread]: 
[0m17:36:13.902379 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=17 SKIP=0 NO-OP=0 TOTAL=17
[0m17:36:13.903825 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.3385103, "process_in_blocks": "0", "process_kernel_time": 0.980143, "process_mem_max_rss": "156828", "process_out_blocks": "2656", "process_user_time": 4.116601}
[0m17:36:13.904889 [debug] [MainThread]: Command `dbt test` failed at 17:36:13.904675 after 2.34 seconds
[0m17:36:13.905500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e26b1a83b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e26b0162a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74e26c1e54f0>]}
[0m17:36:13.906365 [debug] [MainThread]: Flushing usage events
[0m17:36:14.673141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:11.889616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794da96b5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794da86a9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794daa357c50>]}


============================== 17:39:11.895179 | 8951b3f0-043a-43f8-9080-00c083513dfb ==============================
[0m17:39:11.895179 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:39:11.895978 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'profiles_dir': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/profiles', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'debug': 'False', 'log_path': '/home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/logs', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt test --project-dir /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'no_print': 'None'}
[0m17:39:12.302492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8951b3f0-043a-43f8-9080-00c083513dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794d9bc53050>]}
[0m17:39:12.398341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8951b3f0-043a-43f8-9080-00c083513dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794da80a69c0>]}
[0m17:39:12.400761 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m17:39:12.585844 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:39:12.745471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:39:12.746082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:39:12.799294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8951b3f0-043a-43f8-9080-00c083513dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794d9bd733b0>]}
[0m17:39:12.928088 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:39:12.934666 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:39:12.978712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8951b3f0-043a-43f8-9080-00c083513dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794d999c9f70>]}
[0m17:39:12.979495 [info ] [MainThread]: Found 2 models, 17 data tests, 470 macros
[0m17:39:12.980073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8951b3f0-043a-43f8-9080-00c083513dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794d99b4c080>]}
[0m17:39:12.983385 [info ] [MainThread]: 
[0m17:39:12.983971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:39:12.984448 [info ] [MainThread]: 
[0m17:39:12.985219 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:39:12.992254 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m17:39:13.056794 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:39:13.057447 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m17:39:13.057872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:13.085188 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:39:13.086278 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:39:13.087022 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m17:39:13.108447 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m17:39:13.110297 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m17:39:13.111807 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m17:39:13.112353 [debug] [ThreadPool]: On list_medallion_main: Close
[0m17:39:13.113758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8951b3f0-043a-43f8-9080-00c083513dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794d9bcddfa0>]}
[0m17:39:13.114390 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:13.114874 [debug] [MainThread]: On master: BEGIN
[0m17:39:13.115286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:13.117067 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:39:13.117765 [debug] [MainThread]: On master: COMMIT
[0m17:39:13.118685 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:13.119489 [debug] [MainThread]: On master: COMMIT
[0m17:39:13.122824 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:39:13.125103 [debug] [MainThread]: On master: Close
[0m17:39:13.133921 [debug] [Thread-1 (]: Began running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:39:13.134650 [debug] [Thread-2 (]: Began running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:39:13.135408 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:39:13.136550 [debug] [Thread-4 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:39:13.135985 [info ] [Thread-1 (]: 1 of 17 START test accepted_values_stg_transactions_status__completed__pending__failed  [RUN]
[0m17:39:13.137556 [info ] [Thread-2 (]: 2 of 17 START test id_valido_fct_customer_transactions_customer_id ............. [RUN]
[0m17:39:13.138481 [info ] [Thread-3 (]: 3 of 17 START test non_negative_fct_customer_transactions_total_amount_all ..... [RUN]
[0m17:39:13.139389 [info ] [Thread-4 (]: 4 of 17 START test non_negative_fct_customer_transactions_total_amount_completed  [RUN]
[0m17:39:13.141388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main, now test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26)
[0m17:39:13.143144 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:39:13.144439 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:39:13.145614 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:39:13.146284 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:39:13.146922 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:39:13.147532 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:39:13.148217 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:39:13.179179 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:39:13.181659 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:39:13.188409 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:39:13.194672 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:39:13.196563 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:39:13.197271 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:39:13.198196 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:39:13.238136 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:39:13.259743 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:39:13.261008 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:39:13.263929 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:39:13.266627 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:39:13.270374 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:39:13.272227 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:39:13.273794 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: BEGIN
[0m17:39:13.275897 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:39:13.277924 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:39:13.278955 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: BEGIN
[0m17:39:13.280113 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:39:13.281497 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: BEGIN
[0m17:39:13.282515 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: BEGIN
[0m17:39:13.285749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:13.288313 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:39:13.289602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:39:13.290592 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:39:13.294100 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:39:13.294677 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:39:13.295222 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"
[0m17:39:13.295873 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:39:13.296387 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"
[0m17:39:13.297060 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"
[0m17:39:13.297705 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.298352 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"
[0m17:39:13.298997 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:39:13.299637 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.301611 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

"""
Test para verificar que el id utilizado sea válido. 
Se asume que un id es válido si se trata de un entero mayor a 1000.
"""

select
    customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id > 1000 or customer_id is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.302693 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.304577 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.305836 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all < 0 or total_amount_all is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.306769 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "medallion"."main"."stg_transactions"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','pending','failed'
)



  
  
      
    ) dbt_internal_test
[0m17:39:13.308289 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: ROLLBACK
[0m17:39:13.309421 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed < 0 or total_amount_completed is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.310183 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.310928 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.314305 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.316059 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: ROLLBACK
[0m17:39:13.318970 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: ROLLBACK
[0m17:39:13.321251 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: ROLLBACK
[0m17:39:13.345332 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89'
[0m17:39:13.348056 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428'
[0m17:39:13.349867 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad'
[0m17:39:13.351960 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26'
[0m17:39:13.352584 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89: Close
[0m17:39:13.353327 [debug] [Thread-4 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428: Close
[0m17:39:13.354046 [debug] [Thread-2 (]: On test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad: Close
[0m17:39:13.354770 [debug] [Thread-1 (]: On test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26: Close
[0m17:39:13.369582 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:13.373257 [debug] [Thread-2 (]: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:39:13.376266 [error] [Thread-3 (]: 3 of 17 ERROR non_negative_fct_customer_transactions_total_amount_all .......... [[31mERROR[0m in 0.23s]
[0m17:39:13.378908 [debug] [Thread-4 (]: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:13.379912 [error] [Thread-2 (]: 2 of 17 ERROR id_valido_fct_customer_transactions_customer_id .................. [[31mERROR[0m in 0.24s]
[0m17:39:13.381334 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89
[0m17:39:13.382924 [debug] [Thread-1 (]: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:39:13.383778 [error] [Thread-4 (]: 4 of 17 ERROR non_negative_fct_customer_transactions_total_amount_completed .... [[31mERROR[0m in 0.24s]
[0m17:39:13.384861 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad
[0m17:39:13.385574 [debug] [Thread-3 (]: Began running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:39:13.386303 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:39:13.387242 [error] [Thread-1 (]: 1 of 17 ERROR accepted_values_stg_transactions_status__completed__pending__failed  [[31mERROR[0m in 0.25s]
[0m17:39:13.388288 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428
[0m17:39:13.389228 [debug] [Thread-2 (]: Began running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:39:13.390716 [info ] [Thread-3 (]: 5 of 17 START test non_negative_fct_customer_transactions_transaction_count .... [RUN]
[0m17:39:13.392474 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad' to be skipped because of status 'error'.  Reason: Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^.
[0m17:39:13.393431 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26
[0m17:39:13.394183 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:39:13.394871 [info ] [Thread-2 (]: 6 of 17 START test non_negative_stg_transactions_amount ........................ [RUN]
[0m17:39:13.395702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_all.1032e62a89, now test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4)
[0m17:39:13.396591 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:39:13.397889 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:39:13.399358 [info ] [Thread-4 (]: 7 of 17 START test not_null_fct_customer_transactions_customer_id .............. [RUN]
[0m17:39:13.400875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.id_valido_fct_customer_transactions_customer_id.41c35f96ad, now test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733)
[0m17:39:13.401917 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:39:13.403088 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26' to be skipped because of status 'error'.  Reason: Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^.
[0m17:39:13.403797 [info ] [Thread-1 (]: 8 of 17 START test not_null_fct_customer_transactions_total_amount_all ......... [RUN]
[0m17:39:13.404961 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_total_amount_completed.b85991a428, now test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c)
[0m17:39:13.405983 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:39:13.413520 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:39:13.414770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.accepted_values_stg_transactions_status__completed__pending__failed.e52c83ab26, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f)
[0m17:39:13.415429 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:39:13.420217 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:39:13.421415 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:39:13.431070 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:39:13.431984 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:39:13.437774 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:39:13.444505 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:39:13.446072 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:39:13.447600 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:39:13.450781 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:39:13.451890 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:39:13.456416 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:39:13.457299 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:39:13.460594 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:39:13.462154 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:39:13.462931 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: BEGIN
[0m17:39:13.463927 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: BEGIN
[0m17:39:13.464687 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:39:13.465383 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:39:13.465943 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:39:13.466567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:39:13.467182 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: BEGIN
[0m17:39:13.468258 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: BEGIN
[0m17:39:13.469471 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:39:13.470001 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:39:13.470568 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:39:13.471147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:13.472187 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"
[0m17:39:13.473819 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"
[0m17:39:13.475133 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:39:13.476344 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.477139 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:39:13.477919 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.478797 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"
[0m17:39:13.480350 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"
[0m17:39:13.482080 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count < 0 or transaction_count is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.485232 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.486703 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

-- TODO: Implementar el test para verificar que los valores en la columna son no negativos y no nulos.

select
    amount
from "medallion"."main"."stg_transactions"
where amount < 0 or amount is null


  
  
      
    ) dbt_internal_test
[0m17:39:13.487849 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.489456 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.491730 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.493513 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."fct_customer_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.495148 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: ROLLBACK
[0m17:39:13.495887 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_all
from "medallion"."main"."fct_customer_transactions"
where total_amount_all is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.496750 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: ROLLBACK
[0m17:39:13.497386 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.499428 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.501345 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4'
[0m17:39:13.503615 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: ROLLBACK
[0m17:39:13.505647 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733'
[0m17:39:13.506547 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: ROLLBACK
[0m17:39:13.507215 [debug] [Thread-3 (]: On test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4: Close
[0m17:39:13.511130 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c'
[0m17:39:13.511867 [debug] [Thread-2 (]: On test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733: Close
[0m17:39:13.516022 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c: Close
[0m17:39:13.518722 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f'
[0m17:39:13.523146 [debug] [Thread-3 (]: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:13.527534 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f: Close
[0m17:39:13.530303 [debug] [Thread-2 (]: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:13.532961 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:13.531387 [error] [Thread-3 (]: 5 of 17 ERROR non_negative_fct_customer_transactions_transaction_count ......... [[31mERROR[0m in 0.14s]
[0m17:39:13.534981 [error] [Thread-2 (]: 6 of 17 ERROR non_negative_stg_transactions_amount ............................. [[31mERROR[0m in 0.13s]
[0m17:39:13.537218 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:13.537986 [error] [Thread-4 (]: 7 of 17 ERROR not_null_fct_customer_transactions_customer_id ................... [[31mERROR[0m in 0.13s]
[0m17:39:13.539429 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4
[0m17:39:13.540890 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733
[0m17:39:13.542121 [error] [Thread-1 (]: 8 of 17 ERROR not_null_fct_customer_transactions_total_amount_all .............. [[31mERROR[0m in 0.13s]
[0m17:39:13.543294 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c
[0m17:39:13.544074 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:39:13.544916 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:39:13.545519 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:39:13.546388 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f
[0m17:39:13.547137 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:39:13.547888 [info ] [Thread-3 (]: 9 of 17 START test not_null_fct_customer_transactions_total_amount_completed ... [RUN]
[0m17:39:13.548961 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733' to be skipped because of status 'error'.  Reason: Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^.
[0m17:39:13.550053 [info ] [Thread-2 (]: 10 of 17 START test not_null_fct_customer_transactions_transaction_count ....... [RUN]
[0m17:39:13.551607 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:39:13.553441 [info ] [Thread-4 (]: 11 of 17 START test not_null_stg_transactions_amount ........................... [RUN]
[0m17:39:13.555440 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_fct_customer_transactions_transaction_count.df8b0df1a4, now test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418)
[0m17:39:13.556887 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:39:13.557935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.non_negative_stg_transactions_amount.cc30daf733, now test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e)
[0m17:39:13.559345 [info ] [Thread-1 (]: 12 of 17 START test not_null_stg_transactions_customer_id ...................... [RUN]
[0m17:39:13.560269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_customer_id.8253bbdb2c, now test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e)
[0m17:39:13.561040 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:39:13.562211 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:39:13.562998 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:39:13.563824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_all.0a661a703f, now test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf)
[0m17:39:13.564539 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:39:13.573555 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:39:13.584047 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:39:13.585019 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:39:13.711796 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:39:13.717472 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:39:13.718625 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:39:13.719489 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:39:13.723056 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:39:13.723961 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:39:13.726651 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:39:13.727169 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:39:13.730136 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:39:13.731218 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:39:13.734738 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:39:13.737321 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: BEGIN
[0m17:39:13.738796 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:39:13.740341 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:39:13.741674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:39:13.742804 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: BEGIN
[0m17:39:13.743871 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:39:13.744593 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m17:39:13.746593 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:39:13.747634 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: BEGIN
[0m17:39:13.748170 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:39:13.748801 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:39:13.749712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:13.750339 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:39:13.750861 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"
[0m17:39:13.752095 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:39:13.752854 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"
[0m17:39:13.753345 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:39:13.753966 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.754562 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"
[0m17:39:13.755341 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.756106 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"
[0m17:39:13.757307 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.758021 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "medallion"."main"."fct_customer_transactions"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.758988 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.759739 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount_completed
from "medallion"."main"."fct_customer_transactions"
where total_amount_completed is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.760846 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.761676 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "medallion"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.762866 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.763597 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "medallion"."main"."stg_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.764293 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: ROLLBACK
[0m17:39:13.764976 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.765688 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: ROLLBACK
[0m17:39:13.766314 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.769799 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m17:39:13.771793 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e'
[0m17:39:13.774557 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: ROLLBACK
[0m17:39:13.778494 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418'
[0m17:39:13.779620 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e: Close
[0m17:39:13.781581 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e'
[0m17:39:13.783559 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418: Close
[0m17:39:13.785583 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf'
[0m17:39:13.786627 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e: Close
[0m17:39:13.790555 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf: Close
[0m17:39:13.795017 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:13.796949 [debug] [Thread-2 (]: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:13.805269 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:13.801338 [error] [Thread-3 (]: 9 of 17 ERROR not_null_fct_customer_transactions_total_amount_completed ........ [[31mERROR[0m in 0.25s]
[0m17:39:13.808975 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:13.810823 [error] [Thread-2 (]: 10 of 17 ERROR not_null_fct_customer_transactions_transaction_count ............ [[31mERROR[0m in 0.25s]
[0m17:39:13.812111 [error] [Thread-4 (]: 11 of 17 ERROR not_null_stg_transactions_amount ................................ [[31mERROR[0m in 0.25s]
[0m17:39:13.813691 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418
[0m17:39:13.814709 [error] [Thread-1 (]: 12 of 17 ERROR not_null_stg_transactions_customer_id ........................... [[31mERROR[0m in 0.25s]
[0m17:39:13.815732 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e
[0m17:39:13.816519 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e
[0m17:39:13.817288 [debug] [Thread-3 (]: Began running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:39:13.818000 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:39:13.818758 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf
[0m17:39:13.819413 [debug] [Thread-2 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:39:13.820128 [debug] [Thread-4 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:39:13.820932 [info ] [Thread-3 (]: 13 of 17 START test not_null_stg_transactions_status ........................... [RUN]
[0m17:39:13.822429 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^.
[0m17:39:13.823384 [debug] [Thread-1 (]: Began running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:39:13.824110 [info ] [Thread-2 (]: 14 of 17 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m17:39:13.824932 [info ] [Thread-4 (]: 15 of 17 START test not_null_stg_transactions_transaction_id ................... [RUN]
[0m17:39:13.825967 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_total_amount_completed.989f790418, now test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875)
[0m17:39:13.826799 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:39:13.827461 [info ] [Thread-1 (]: 16 of 17 START test not_null_stg_transactions_transaction_ts ................... [RUN]
[0m17:39:13.828285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_fct_customer_transactions_transaction_count.7466a4c02e, now test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c)
[0m17:39:13.829077 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_amount.3629b5421e, now test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4)
[0m17:39:13.829890 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:39:13.830800 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:39:13.831626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_customer_id.ea7b0d99bf, now test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7)
[0m17:39:13.832448 [debug] [Thread-2 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:39:13.833322 [debug] [Thread-4 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:39:13.839164 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:39:13.841292 [debug] [Thread-1 (]: Began compiling node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:39:13.847800 [debug] [Thread-2 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:39:13.853341 [debug] [Thread-4 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:39:13.859235 [debug] [Thread-1 (]: Writing injected SQL for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:39:13.860588 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:39:13.861824 [debug] [Thread-2 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:39:13.866760 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:39:13.867452 [debug] [Thread-1 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:39:13.868081 [debug] [Thread-4 (]: Began executing node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:39:13.870680 [debug] [Thread-2 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:39:13.873753 [debug] [Thread-1 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:39:13.876495 [debug] [Thread-4 (]: Writing runtime sql for node "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:39:13.877213 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:39:13.879299 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:39:13.881348 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: BEGIN
[0m17:39:13.883170 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:39:13.884950 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:39:13.886228 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: BEGIN
[0m17:39:13.887883 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:39:13.889492 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m17:39:13.890566 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: BEGIN
[0m17:39:13.891447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:13.893184 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:39:13.893905 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:39:13.894411 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m17:39:13.896252 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:39:13.896944 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"
[0m17:39:13.897521 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:39:13.898102 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:39:13.898584 [debug] [Thread-1 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"
[0m17:39:13.899161 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.899770 [debug] [Thread-2 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"
[0m17:39:13.900406 [debug] [Thread-4 (]: Using duckdb connection "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"
[0m17:39:13.901184 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.902255 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.903039 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "medallion"."main"."stg_transactions"
where status is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.903581 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.905231 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_ts
from "medallion"."main"."stg_transactions"
where transaction_ts is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.906392 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.907242 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "medallion"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.908211 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.908894 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "medallion"."main"."stg_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m17:39:13.910021 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: ROLLBACK
[0m17:39:13.910907 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.912034 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: ROLLBACK
[0m17:39:13.912960 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.915283 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m17:39:13.919091 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875'
[0m17:39:13.920132 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: ROLLBACK
[0m17:39:13.925203 [debug] [Thread-3 (]: On test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875: Close
[0m17:39:13.928072 [debug] [Thread-1 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7'
[0m17:39:13.932936 [debug] [Thread-2 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c'
[0m17:39:13.935497 [debug] [Thread-1 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7: Close
[0m17:39:13.937573 [debug] [Thread-4 (]: Failed to rollback 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4'
[0m17:39:13.938336 [debug] [Thread-2 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m17:39:13.940539 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:13.942793 [debug] [Thread-4 (]: On test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4: Close
[0m17:39:13.945248 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:13.947321 [error] [Thread-3 (]: 13 of 17 ERROR not_null_stg_transactions_status ................................ [[31mERROR[0m in 0.12s]
[0m17:39:13.949802 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:13.952274 [error] [Thread-1 (]: 16 of 17 ERROR not_null_stg_transactions_transaction_ts ........................ [[31mERROR[0m in 0.12s]
[0m17:39:13.953556 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875
[0m17:39:13.955489 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:13.956742 [error] [Thread-2 (]: 14 of 17 ERROR not_null_stg_transactions_transaction_date ...................... [[31mERROR[0m in 0.13s]
[0m17:39:13.957794 [debug] [Thread-1 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7
[0m17:39:13.958512 [debug] [Thread-3 (]: Began running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:39:13.959301 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:39:13.959992 [error] [Thread-4 (]: 15 of 17 ERROR not_null_stg_transactions_transaction_id ........................ [[31mERROR[0m in 0.13s]
[0m17:39:13.961020 [debug] [Thread-2 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c
[0m17:39:13.962228 [info ] [Thread-3 (]: 17 of 17 START test unique_stg_transactions_transaction_id ..................... [RUN]
[0m17:39:13.963964 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:39:13.965138 [debug] [Thread-4 (]: Finished running node test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4
[0m17:39:13.967225 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medallion_dbt.not_null_stg_transactions_status.c7c2fec875, now test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396)
[0m17:39:13.969215 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:39:13.970311 [debug] [Thread-3 (]: Began compiling node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:39:13.971607 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^.
[0m17:39:13.982311 [debug] [Thread-3 (]: Writing injected SQL for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:39:13.983802 [debug] [Thread-3 (]: Began executing node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:39:13.986393 [debug] [Thread-3 (]: Writing runtime sql for node "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:39:13.987276 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:39:13.987774 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: BEGIN
[0m17:39:13.988368 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:39:13.989939 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:39:13.990608 [debug] [Thread-3 (]: Using duckdb connection "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"
[0m17:39:13.991336 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:39:13.992563 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "medallion"."main"."stg_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:39:13.993232 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m17:39:13.993901 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: ROLLBACK
[0m17:39:13.998219 [debug] [Thread-3 (]: Failed to rollback 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396'
[0m17:39:13.999127 [debug] [Thread-3 (]: On test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396: Close
[0m17:39:14.002306 [debug] [Thread-3 (]: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:14.003156 [error] [Thread-3 (]: 17 of 17 ERROR unique_stg_transactions_transaction_id .......................... [[31mERROR[0m in 0.04s]
[0m17:39:14.004034 [debug] [Thread-3 (]: Finished running node test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396
[0m17:39:14.005213 [debug] [Thread-7 (]: Marking all children of 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^.
[0m17:39:14.012603 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:14.013253 [debug] [MainThread]: On master: BEGIN
[0m17:39:14.013708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:39:14.015263 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:39:14.015817 [debug] [MainThread]: On master: COMMIT
[0m17:39:14.016297 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:14.016809 [debug] [MainThread]: On master: COMMIT
[0m17:39:14.018073 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:39:14.018550 [debug] [MainThread]: On master: Close
[0m17:39:14.019125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:14.019529 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_ts.414f2f36a7' was properly closed.
[0m17:39:14.019975 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m17:39:14.020373 [debug] [MainThread]: Connection 'test.medallion_dbt.unique_stg_transactions_transaction_id.ee9a78a396' was properly closed.
[0m17:39:14.020938 [debug] [MainThread]: Connection 'test.medallion_dbt.not_null_stg_transactions_transaction_id.1d00a8e2e4' was properly closed.
[0m17:39:14.021483 [info ] [MainThread]: 
[0m17:39:14.022406 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m17:39:14.026768 [debug] [MainThread]: Command end result
[0m17:39:14.067084 [debug] [MainThread]: Wrote artifact WritableManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/manifest.json
[0m17:39:14.071642 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/semantic_manifest.json
[0m17:39:14.085186 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/carca/wslDocumentos/Codigo/examen_ing_de_sw_2_carcagno_marin/dbt/target/run_results.json
[0m17:39:14.085724 [info ] [MainThread]: 
[0m17:39:14.086367 [info ] [MainThread]: [31mCompleted with 17 errors, 0 partial successes, and 0 warnings:[0m
[0m17:39:14.086873 [info ] [MainThread]: 
[0m17:39:14.087455 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:39:14.088159 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:14.088838 [info ] [MainThread]: 
[0m17:39:14.089541 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_all.sql
[0m17:39:14.090057 [info ] [MainThread]: 
[0m17:39:14.091189 [error] [MainThread]: [31mFailure in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:39:14.091770 [error] [MainThread]:   Runtime Error in test id_valido_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Parser Error: syntax error at or near "select"
  
  LINE 15: """
           ^
[0m17:39:14.092293 [info ] [MainThread]: 
[0m17:39:14.092908 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/id_valido_fct_customer_transactions_customer_id.sql
[0m17:39:14.093604 [info ] [MainThread]: 
[0m17:39:14.094198 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:39:14.094752 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:14.095546 [info ] [MainThread]: 
[0m17:39:14.096232 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_total_amount_completed.sql
[0m17:39:14.096779 [info ] [MainThread]: 
[0m17:39:14.097579 [error] [MainThread]: [31mFailure in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)[0m
[0m17:39:14.098190 [error] [MainThread]:   Runtime Error in test accepted_values_stg_transactions_status__completed__pending__failed (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 20:     from "medallion"."main"."stg_transactions"
                    ^
[0m17:39:14.098672 [info ] [MainThread]: 
[0m17:39:14.099258 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/accepted_values_stg_transactio_5bdf616555c30e299c6e421df7d58f81.sql
[0m17:39:14.099785 [info ] [MainThread]: 
[0m17:39:14.100424 [error] [MainThread]: [31mFailure in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:39:14.102053 [error] [MainThread]:   Runtime Error in test non_negative_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 16: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:14.103124 [info ] [MainThread]: 
[0m17:39:14.103882 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/non_negative_fct_customer_transactions_transaction_count.sql
[0m17:39:14.105393 [info ] [MainThread]: 
[0m17:39:14.106557 [error] [MainThread]: [31mFailure in test non_negative_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:39:14.107406 [error] [MainThread]:   Runtime Error in test non_negative_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 16: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:14.108003 [info ] [MainThread]: 
[0m17:39:14.108823 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/non_negative_stg_transactions_amount.sql
[0m17:39:14.109533 [info ] [MainThread]: 
[0m17:39:14.110154 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)[0m
[0m17:39:14.110709 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_customer_id (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:14.111355 [info ] [MainThread]: 
[0m17:39:14.112783 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_customer_id.sql
[0m17:39:14.114105 [info ] [MainThread]: 
[0m17:39:14.114902 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)[0m
[0m17:39:14.115670 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_all (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:14.116200 [info ] [MainThread]: 
[0m17:39:14.117081 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_all.sql
[0m17:39:14.117755 [info ] [MainThread]: 
[0m17:39:14.118519 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)[0m
[0m17:39:14.119163 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_total_amount_completed (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:14.119948 [info ] [MainThread]: 
[0m17:39:14.120559 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_total_amount_completed.sql
[0m17:39:14.121193 [info ] [MainThread]: 
[0m17:39:14.122413 [error] [MainThread]: [31mFailure in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)[0m
[0m17:39:14.123412 [error] [MainThread]:   Runtime Error in test not_null_fct_customer_transactions_transaction_count (models/marts/schema.yml)
  Catalog Error: Table with name fct_customer_transactions does not exist!
  Did you mean "information_schema.check_constraints"?
  
  LINE 17: from "medallion"."main"."fct_customer_transactions"
                ^
[0m17:39:14.124175 [info ] [MainThread]: 
[0m17:39:14.125264 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/marts/schema.yml/not_null_fct_customer_transactions_transaction_count.sql
[0m17:39:14.125897 [info ] [MainThread]: 
[0m17:39:14.126482 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_amount (models/staging/schema.yml)[0m
[0m17:39:14.127037 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_amount (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:14.127519 [info ] [MainThread]: 
[0m17:39:14.128056 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_amount.sql
[0m17:39:14.128521 [info ] [MainThread]: 
[0m17:39:14.129100 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_customer_id (models/staging/schema.yml)[0m
[0m17:39:14.129674 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_customer_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:14.130134 [info ] [MainThread]: 
[0m17:39:14.130662 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_customer_id.sql
[0m17:39:14.131217 [info ] [MainThread]: 
[0m17:39:14.131807 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_status (models/staging/schema.yml)[0m
[0m17:39:14.132378 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_status (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:14.132873 [info ] [MainThread]: 
[0m17:39:14.133571 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_status.sql
[0m17:39:14.134145 [info ] [MainThread]: 
[0m17:39:14.134915 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)[0m
[0m17:39:14.135655 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_ts (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:14.136987 [info ] [MainThread]: 
[0m17:39:14.137885 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_ts.sql
[0m17:39:14.138791 [info ] [MainThread]: 
[0m17:39:14.139871 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)[0m
[0m17:39:14.140974 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_date (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:14.141996 [info ] [MainThread]: 
[0m17:39:14.143102 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_date.sql
[0m17:39:14.143825 [info ] [MainThread]: 
[0m17:39:14.145983 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:39:14.147868 [error] [MainThread]:   Runtime Error in test not_null_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:14.149106 [info ] [MainThread]: 
[0m17:39:14.149828 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/not_null_stg_transactions_transaction_id.sql
[0m17:39:14.150494 [info ] [MainThread]: 
[0m17:39:14.151223 [error] [MainThread]: [31mFailure in test unique_stg_transactions_transaction_id (models/staging/schema.yml)[0m
[0m17:39:14.152087 [error] [MainThread]:   Runtime Error in test unique_stg_transactions_transaction_id (models/staging/schema.yml)
  Catalog Error: Table with name stg_transactions does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 18: from "medallion"."main"."stg_transactions"
                ^
[0m17:39:14.152646 [info ] [MainThread]: 
[0m17:39:14.153278 [info ] [MainThread]:   compiled code at target/compiled/medallion_dbt/models/staging/schema.yml/unique_stg_transactions_transaction_id.sql
[0m17:39:14.153758 [info ] [MainThread]: 
[0m17:39:14.154270 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=17 SKIP=0 NO-OP=0 TOTAL=17
[0m17:39:14.155826 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.3566985, "process_in_blocks": "0", "process_kernel_time": 1.001784, "process_mem_max_rss": "157196", "process_out_blocks": "2656", "process_user_time": 4.094944}
[0m17:39:14.156742 [debug] [MainThread]: Command `dbt test` failed at 17:39:14.156486 after 2.36 seconds
[0m17:39:14.157631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794da8183ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794da9621e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794da7780c80>]}
[0m17:39:14.158390 [debug] [MainThread]: Flushing usage events
[0m17:39:14.934405 [debug] [MainThread]: An error was encountered while trying to flush usage events
